---
title: "05-Registration_to_LuskinMs2024"
author: "Bernie Mulvey"
date: "2025-01-28"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.height = 10,fig.width = 7,include = FALSE)
#### sets tab autocompletion for directories to begin from the directory containing the .Rproj session, instead of the script's directory if different
knitr::opts_knit$set(root.dir = here::here())

library(data.table)
library(ggplot2)
library(ggtext)
library(gridExtra)
library(SingleCellExperiment)
library(Seurat)
library(presto)
library(readxl)
# library(SpatialFeatureExperiment)

## rstudio GUI tweaks
require(colorout)
ColorOut()
options("styler.addins_style_transformer" = "biocthis::bioc_style()")
##

## enable forked parallel processing with BiocParallel::multicoreParam, future::, etc. seemed to need this a couple times, but otherwise havent so its here as a preventative measure. part of this is adding the line 
# OBJC_DISABLE_INITIALIZE_FORK_SAFETY=YES
# to Renviron.site. see e.g. top response on https://stackoverflow.com/questions/73638290/python-on-mac-is-it-safe-to-set-objc-disable-initialize-fork-safety-yes-globall 
library(parallelly)
options(parallelly.supportsMulticore.disableOn="")
options(parallelly.fork.enable=TRUE)
library(BiocParallel)
options(bphost="localhost")


## ggplot defaults
theme_set(theme_bw()+theme(axis.text.x = element_text(size = 9), axis.title.x = element_text(size = 8), axis.text.y = element_text(size = 8), axis.title.y = element_text(size =9), plot.title = element_markdown(size = 11,hjust=0.5), strip.text = element_text(size=11), legend.text = element_text(size=8), legend.title = element_text(size=9,hjust=0.5)))

## last of all, unload the base package datasets, whose data keep getting in the way of autocompletions (e.g., Theoph is priortized over TRUE)
unloadNamespace("datasets")
```



load the all cells seurat object, which has the problematic female sample already removed as it was in the manuscript. the object has has unannotated numerical cluster labels, but andrew luskin provided the look-up table between these values and the annotations used in the paper (along with the number of cells that are in each cluster for sanity checking).
```{r}
lca <- readRDS("~/Desktop/KM Lab/Other Groups\' Published Data/Luskin Bruchas mouse periLC snseq publication RDSes/LC_integrated_allcells.rds")

## convert to singlecellexperiment
lca <- as.SingleCellExperiment(lca)

## read lookup table to add real cluster annots. for neuron subtype labels, there is a blank for nonneuron clusters
cluslut <- fread("~/Desktop/KM Lab/Other Groups\' Published Data/Luskin Bruchas mouse periLC snseq publication RDSes/luskin_allcellsRDS_snnres03_cluster_lookuptable_013025.txt")
## the cluster numbers (Index) here start at 1, while in the SCE they start at 0, so subtracted 1 and make character
cluslut[,Index:=paste0("x",as.character(Index-1))]
## add real cluster annots
tmpcd <- as.data.table(colData(lca),keep.rownames=T)

## mscript annots are in integrated_snn_res.0.3
tmpcd[,integrated_snn_res.0.3:=as.character(integrated_snn_res.0.3)]
tmpcd[,integrated_snn_res.0.3:=paste0("x",integrated_snn_res.0.3)]

stopifnot(all(cluslut$Index %in% tmpcd$integrated_snn_res.0.3))

tmpcd <- merge(tmpcd,cluslut,by.x="integrated_snn_res.0.3",by.y="Index",all.x=T)

## there also isn't an actual sample_id column here (though the sample ids are appended to the cell barcodes), so we can split a sample id column off
tmpcd[,sample_id:=gsub(rn,pattern="^.*(LC.*$)",replacement="\\1")]
# there should be three samples (2 male one female)
stopifnot(length(unique(tmpcd$sample_id))==3)

tmpcd <- DataFrame(tmpcd,row.names=tmpcd$rn)[colnames(lca),]

colData(lca) <- tmpcd
```

### run registration wrapper with the nonneuronal cells still in there (because we need to compare to Visium, which has plenty of  glia)
### HOWEVER in accordance with the manuscript, exclude VGLUT1 cells, which they demonstrated weren't actually a thing in the microdissections
```{r}
sum(lca$neuronSubtype_label=="vGLUT1_neurons")
# 2772; so filtered sce should be 30818-2772 = 28046 cells

lca <- lca[,lca$neuronSubtype_label!="vGLUT1_neurons"]
stopifnot(ncol(lca)==28046)
```

## load the LFF data, apply the HDGSVG 2575 cluster labels
```{r}
lff <- readRDS("~/Desktop/KM Lab/local_lffLC/LFF_spatial_LC/processed-data/06-countsOnly_noImgData_QCed_SPE_split_to_tissSections.RDS")

louvs <- readRDS("~/Desktop/KM Lab/local_lffLC/LFF_spatial_LC/processed-data/07_featureSelection_dimred_harmony_clustering/04-Initial_louvLeid_res0.5-1-2_clusterings.RDS")
louvs <- louvs$HARMONYlmbna_HDG_SVG_2575[,.(rn,snnHARMONYlmbna_HDG_SVG_2575_louv_res1)]
setnames(louvs,2,"clusid")

autoan <- readRDS("~/Desktop/KM Lab/local_lffLC/LFF_spatial_LC/processed-data/07_featureSelection_dimred_harmony_clustering/05b-init_clusterings_autoannoLCrapheAndGABAergic.RDS")
autoan <- autoan$snnHARMONYlmbna_HDG_SVG_2575_louv_res1

louvs <- merge.data.table(louvs,autoan,by="clusid")
# change 5HT labels to not have a leading digit
louvs[autoanno %in% c("5HT.1","5HT.2"),autoanno:=paste0("x",autoanno)]

louvs <- DataFrame(louvs,row.names=louvs$rn)[colnames(lff),]

colLabels(lff) <- louvs$autoanno
```

### grab genes with 1-1 orthologs between the two datasets, subset to those genes for marker analysis
```{r}
## map mouse genes in lcareg to human orthologs
# gprofiler web service is down -- error 301 on queries both from my machine and using JHPCE. manually queried via https://biit.cs.ut.ee/gprofiler_beta/orth
mhorth <- fread("raw-data/ref_data/gProfiler_mmusculus_hsapiens_1-28-2025_4-42-13 PM.csv",header=T)

# ^ this converted the mouse symbols supplied ("initial") to all caps so convert lca accordingly
## need some rowdata, which there isn't--just symbols as the rownames.
rowData(lca)$gene_name <- rownames(lca)
rowData(lca)$gene_id <- rownames(lca)

## now append an allupper version that we'll use here to filter before switching back to the appropriate case convention
rowData(lca)$gene_name_allupper <- toupper(rowData(lca)$gene_name)
rownames(lca) <- rowData(lca)$gene_name_allupper

# drop rows where human ortholog not found
mhorth <- mhorth[ortholog_ensg!="N/A",]
# drop non 1-to-1 mappings
mhorth <- unique(mhorth[,.(initial_alias,ortholog_ensg)])
dropginit <- mhorth[,.N,by="initial_alias"][N>1,initial_alias]
dropgorth <- mhorth[,.N,by="ortholog_ensg"][N>1,ortholog_ensg]


mhorth <- mhorth[!(ortholog_ensg %in% dropgorth)&!(initial_alias %in% dropginit)]
# filter to genes with orthologs represented in both datasets
mhorth <- mhorth[initial_alias %in% rownames(lca) & ortholog_ensg %in% rownames(lff),]

## filter LFF to the remaining orthologous ENSGs and filt mouse by their allupper names 
lff <- lff[rownames(lff) %in% mhorth$ortholog_ensg,]
lca <- lca[rownames(lca) %in% mhorth$initial_alias,]

## DO NOT restore original lca rownames so we can map back to orthologs after marker analysis
```

## run registration wrapper for neuron subtypes (with everything else in a blanket "other" cluster), or using all annots including nonneuronal clusters
```{r}
lca$neuronSubtype_label[which(lca$neuronSubtype_label=="")] <- "nonneuronal"
# drop problematic / from the vgat-vglut dual neurons
lca$neuronSubtype_label[which(lca$neuronSubtype_label=="vGAT/vGLUT2_neurons")] <- "vGAT_vGLUT2_dual"

library(spatialLIBD)

# provide the allupper gene symbols as the 'ensembl' gene so that it is carried thru for ortholog mapping
lca.subreg <- registration_wrapper(lca,var_registration = "neuronSubtype_label",var_sample_id = "sample_id",gene_name = "gene_name",gene_ensembl = "gene_name_allupper")

lca.allreg <- registration_wrapper(lca,var_registration = "cellType_label",var_sample_id = "sample_id",gene_name = "gene_name",gene_ensembl = "gene_name_allupper")

lcaregs <- list(lca.subreg,lca.allreg)
names(lcaregs) <- c("neuronSubtypes_or_other","allRetainedClusts")
## a quick glance at this sorting by t stat for each cluster checks out (misc neuronal markers and peptides in the top enriched for GABAs, dbh slc6a2 in the top for NE, Chat in the top for ACH). doubt the GABAergic cluster number-gaba annotations are all matched up correctly but still useful for mapping out whether any of those GABA clusters are represented in the lff data.
```

## lff registration wrapper, register
```{r
lffreg <- registration_wrapper(lff,var_registration = "label",var_sample_id = "sample_id",gene_name = "gene_name",gene_ensembl = "gene_id",min_ncells = 5)

## reformat for rewritten registration function
### for lc3:
lff.mk <- as.data.table(lffreg$enrichment)
keepcols <- c("ensembl",grep(names(lff.mk),pattern="^t_stat_",value=T))
lff.mk <- lff.mk[,..keepcols]
    
setnames(lff.mk,c(2:ncol(lff.mk)),gsub(names(lff.mk)[c(2:ncol(lff.mk))],pattern="^t_stat_",replacement=""))

## reformat lcareg the same way
lcaregs <- lapply(lcaregs,function(x){
    lcareg.mk <- as.data.table(x$enrichment)
    keepcols <- c("ensembl",grep(names(lcareg.mk),pattern="^t_stat_",value=T))
    lcareg.mk <- lcareg.mk[,..keepcols]

    ## switch out the mouse symbols ("ensembl") with human ENSGs to map the stats across results; put the human ensg in the first col and drop the mouse symbol col
    lcareg.mk <- merge.data.table(lcareg.mk,mhorth[,.(initial_alias,ortholog_ensg)],by.x="ensembl",by.y="initial_alias",all.x=T)
    lcareg.mk[,ensembl:=NULL]
    reonames <- c("ortholog_ensg",setdiff(names(lcareg.mk),"ortholog_ensg"))
    rettab <- lcareg.mk[,..reonames]
    setnames(rettab,1,"ensembl")

    setnames(rettab,c(2:ncol(rettab)),gsub(names(rettab)[c(2:ncol(rettab))],pattern="^t_stat_",replacement=""))
    return(rettab)
})
```

registration fxn
```{r}
library(parallel)

lcaregs.out <- lapply(X=lcaregs,FUN=function(s){
    # s is the query dataset
    # iterator for top number of genes to use for correlation
    j<-c(seq(10,50,10),seq(75,250,25),seq(300,1000,100))

    m <- copy(lff.mk) # m is the active dataset

    ans <- mclapply(c(1:(length(j)+1)),mc.cores=8,function(i){
        if(i<length(j)){
            cortab<-merge.data.table(m,s,by.y="ensembl",by.x="ensembl")
            ngene <- j[i]
        }
        else{
            # no value for top_n --> all genes used
            cortab<-merge.data.table(m,s,by.y="ensembl",by.x="ensembl")
            ngene <- nrow(cortab)
        }
        # initialize cormat
        nclaba <- ncol(s)
        nclhyp <- ncol(m)
        cormat <- as.data.frame(matrix(nrow=(nclhyp-1),ncol=(nclaba-1)))
        k <- 2
        for (k in c(2:nclhyp)){
            rownames(cormat)[(k-1)] <- colnames(m)[k]
            l <- 2
            for (l in c(2:nclaba)){
                colnames(cormat)[(l-1)] <- colnames(s)[l]
                
                curhyp <- colnames(m)[k]
                curaba <- colnames(s)[l]
                setorderv(cortab,curaba,-1)
                
                cormat[(k-1),(l-1)] <- cor(cortab[c(1:ngene),..curhyp],cortab[c(1:ngene),..curaba],use="pairwise.complete.obs",method = "spearman")
            }
        }
        plttab <- as.data.table(cormat,keep.rownames=T)
        setnames(plttab,"rn","LFFclus")
        plttab[,topNmsmk:=ngene]
        plttab <- melt(plttab,id.vars=c("LFFclus","topNmsmk"))
        setnames(plttab,"variable","msAnnot")
        return(plttab)
    })
    return(ans)
})

## concat
lcaregs.out <- lapply(lcaregs.out,rbindlist)
# save
saveRDS(lcaregs.out,file="processed-data/08_validitycheck_25hdg75svg_louv1/05-Registrations_to_LuskinMs2024.RDS")
```

reprod inf
```{r}
sessionInfo()
sessioninfo::session_info()
```
─ Session info ────────────────────
 setting  value
 version  R version 4.4.1 RC (2024-06-06 r86719)
 os       macOS Sonoma 14.7.1
 system   aarch64, darwin20
 ui       X11
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       America/Chicago
 date     2025-01-31
 pandoc   NA

─ Packages ────────────────────────
 !  package              * version    date (UTC) lib source
    abind                  1.4-8      2024-09-12 [1] CRAN (R 4.4.1)
    AnnotationDbi          1.68.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    AnnotationHub          3.14.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    attempt                0.3.1      2020-05-03 [1] CRAN (R 4.4.0)
    beachmat               2.22.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    beeswarm               0.4.0      2021-06-01 [1] CRAN (R 4.4.0)
    benchmarkme            1.0.8      2022-06-12 [1] CRAN (R 4.4.0)
    benchmarkmeData        1.0.4      2020-04-23 [1] CRAN (R 4.4.0)
    Biobase              * 2.66.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    BiocFileCache          2.14.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    BiocGenerics         * 0.52.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    BiocIO                 1.16.0     2024-12-12 [1] Github (Bioconductor/BiocIO@8e80624)
    BiocManager            1.30.25    2024-08-28 [1] CRAN (R 4.4.1)
    BiocNeighbors          2.0.1      2024-11-28 [1] Bioconductor 3.20 (R 4.4.2)
    BiocParallel         * 1.40.0     2024-11-23 [1] Bioconductor 3.20 (R 4.4.2)
    BiocSingular           1.22.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    BiocVersion            3.20.0     2024-05-04 [1] Bioconductor 3.20 (R 4.4.0)
    Biostrings             2.74.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    bit                    4.5.0.1    2024-12-03 [1] CRAN (R 4.4.1)
    bit64                  4.5.2      2024-09-22 [1] CRAN (R 4.4.1)
    bitops                 1.0-9      2024-10-03 [1] CRAN (R 4.4.1)
    blob                   1.2.4      2023-03-17 [1] CRAN (R 4.4.0)
    bslib                  0.8.0      2024-07-29 [1] CRAN (R 4.4.0)
    cachem                 1.1.0      2024-05-16 [1] CRAN (R 4.4.0)
    cellranger             1.1.0      2016-07-27 [1] CRAN (R 4.4.0)
 P  cli                    3.6.3      2024-06-21 [2] CRAN (R 4.4.0)
    cluster                2.1.8      2024-12-11 [1] CRAN (R 4.4.1)
    codetools              0.2-20     2024-03-31 [1] CRAN (R 4.4.1)
    colorout             * 1.3-0.2    2024-05-01 [1] Github (jalvesaq/colorout@c6113a2)
    colorspace             2.1-1      2024-07-26 [1] CRAN (R 4.4.0)
    config                 0.3.2      2023-08-30 [1] CRAN (R 4.4.0)
    cowplot                1.1.3      2024-01-22 [1] CRAN (R 4.4.0)
    crayon                 1.5.3      2024-06-20 [1] CRAN (R 4.4.0)
    curl                   6.0.1      2024-11-14 [1] CRAN (R 4.4.1)
    data.table           * 1.16.4     2024-12-06 [1] CRAN (R 4.4.1)
    DBI                    1.2.3      2024-06-02 [1] CRAN (R 4.4.0)
    dbplyr                 2.5.0      2024-03-19 [1] CRAN (R 4.4.0)
    DelayedArray           0.32.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    deldir                 2.0-4      2024-02-28 [1] CRAN (R 4.4.0)
    digest                 0.6.37     2024-08-19 [1] CRAN (R 4.4.1)
    doParallel             1.0.17     2022-02-07 [1] CRAN (R 4.4.1)
    dotCall64              1.2        2024-10-04 [1] CRAN (R 4.4.1)
    dplyr                  1.1.4      2023-11-17 [1] CRAN (R 4.4.0)
    DT                     0.33       2024-04-04 [1] CRAN (R 4.4.0)
    edgeR                  4.4.1      2024-12-02 [1] Bioconductor 3.20 (R 4.4.2)
    evaluate               1.0.1      2024-10-10 [1] CRAN (R 4.4.1)
    ExperimentHub          2.14.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    farver                 2.1.2      2024-05-13 [1] CRAN (R 4.4.0)
    fastDummies            1.7.4      2024-08-16 [1] CRAN (R 4.4.0)
    fastmap                1.2.0      2024-05-15 [1] CRAN (R 4.4.0)
    fields                 16.3       2024-09-30 [1] CRAN (R 4.4.1)
    filelock               1.0.3      2023-12-11 [1] CRAN (R 4.4.0)
    fitdistrplus           1.2-1      2024-07-12 [1] CRAN (R 4.4.0)
    foreach                1.5.2      2022-02-02 [1] CRAN (R 4.4.0)
    Formula                1.2-5      2023-02-24 [1] CRAN (R 4.4.0)
    future                 1.34.0     2024-07-29 [1] CRAN (R 4.4.0)
    future.apply           1.11.3     2024-10-27 [1] CRAN (R 4.4.1)
    generics               0.1.3      2022-07-05 [1] CRAN (R 4.4.0)
    GenomeInfoDb         * 1.42.1     2024-11-28 [1] Bioconductor 3.20 (R 4.4.2)
    GenomeInfoDbData       1.2.13     2024-12-12 [1] Bioconductor
    GenomicAlignments      1.42.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    GenomicRanges        * 1.58.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    ggbeeswarm             0.7.2      2023-04-29 [1] CRAN (R 4.4.0)
    ggplot2              * 3.5.1      2024-04-23 [1] CRAN (R 4.4.0)
    ggrepel                0.9.6      2024-09-07 [1] CRAN (R 4.4.1)
    ggridges               0.5.6      2024-01-23 [1] CRAN (R 4.4.0)
    ggtext               * 0.1.2      2022-09-16 [1] CRAN (R 4.4.0)
    globals                0.16.3     2024-03-08 [1] CRAN (R 4.4.0)
    glue                   1.8.0      2024-09-30 [1] CRAN (R 4.4.1)
    goftest                1.2-3      2021-10-07 [1] CRAN (R 4.4.0)
    golem                  0.5.1      2024-08-27 [1] CRAN (R 4.4.1)
    gridExtra            * 2.3        2017-09-09 [1] CRAN (R 4.4.0)
    gridtext               0.1.5      2022-09-16 [1] CRAN (R 4.4.0)
    gtable                 0.3.6      2024-10-25 [1] CRAN (R 4.4.1)
    here                   1.0.1      2020-12-13 [1] CRAN (R 4.4.0)
    htmltools              0.5.8.1    2024-04-04 [1] CRAN (R 4.4.0)
    htmlwidgets            1.6.4      2023-12-06 [1] CRAN (R 4.4.0)
    httpuv                 1.6.15     2024-03-26 [1] CRAN (R 4.4.0)
    httr                   1.4.7      2023-08-15 [1] CRAN (R 4.4.0)
    ica                    1.0-3      2022-07-08 [1] CRAN (R 4.4.0)
    igraph                 2.1.2      2024-12-07 [1] CRAN (R 4.4.1)
    IRanges              * 2.40.1     2024-12-05 [1] Bioconductor 3.20 (R 4.4.2)
    irlba                  2.3.5.1    2022-10-03 [1] CRAN (R 4.4.0)
    iterators              1.0.14     2022-02-05 [1] CRAN (R 4.4.0)
    jquerylib              0.1.4      2021-04-26 [1] CRAN (R 4.4.0)
    jsonlite               1.8.9      2024-09-20 [1] CRAN (R 4.4.1)
    KEGGREST               1.46.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    KernSmooth             2.23-24    2024-05-17 [1] CRAN (R 4.4.1)
    knitr                  1.49       2024-11-08 [1] CRAN (R 4.4.1)
    labeling               0.4.3      2023-08-29 [1] CRAN (R 4.4.0)
    later                  1.4.1      2024-11-27 [1] CRAN (R 4.4.1)
    lattice                0.22-6     2024-03-20 [1] CRAN (R 4.4.1)
    lazyeval               0.2.2      2019-03-15 [1] CRAN (R 4.4.0)
    leiden                 0.4.3.1    2023-11-17 [1] CRAN (R 4.4.0)
    lfe                    3.1.0      2024-11-06 [1] CRAN (R 4.4.1)
    lifecycle              1.0.4      2023-11-07 [1] CRAN (R 4.4.0)
    limma                  3.62.1     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    listenv                0.9.1      2024-01-29 [1] CRAN (R 4.4.0)
    lmtest                 0.9-40     2022-03-21 [1] CRAN (R 4.4.0)
    locfit                 1.5-9.10   2024-06-24 [1] CRAN (R 4.4.0)
    magick                 2.8.5      2024-09-20 [1] CRAN (R 4.4.1)
    magrittr               2.0.3      2022-03-30 [1] CRAN (R 4.4.0)
    maps                   3.4.2.1    2024-11-10 [1] CRAN (R 4.4.1)
    MASS                   7.3-61     2024-06-13 [1] CRAN (R 4.4.0)
    Matrix                 1.7-1      2024-10-18 [1] CRAN (R 4.4.1)
    MatrixGenerics       * 1.18.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    matrixStats          * 1.4.1      2024-09-08 [1] CRAN (R 4.4.1)
    memoise                2.0.1      2021-11-26 [1] CRAN (R 4.4.0)
    mime                   0.12       2021-09-28 [1] CRAN (R 4.4.0)
    miniUI                 0.1.1.1    2018-05-18 [1] CRAN (R 4.4.0)
    munsell                0.5.1      2024-04-01 [1] CRAN (R 4.4.0)
    nlme                   3.1-166    2024-08-14 [1] CRAN (R 4.4.0)
    paletteer              1.6.0      2024-01-21 [1] CRAN (R 4.4.0)
    parallelly           * 1.40.1     2024-12-04 [1] CRAN (R 4.4.1)
    patchwork              1.3.0      2024-09-16 [1] CRAN (R 4.4.1)
    pbapply                1.7-2      2023-06-27 [1] CRAN (R 4.4.0)
    pillar                 1.10.1     2025-01-07 [1] CRAN (R 4.4.1)
    pkgconfig              2.0.3      2019-09-22 [1] CRAN (R 4.4.0)
    plotly                 4.10.4     2024-01-13 [1] CRAN (R 4.4.0)
    plyr                   1.8.9      2023-10-02 [1] CRAN (R 4.4.0)
    png                    0.1-8      2022-11-29 [1] CRAN (R 4.4.0)
    polyclip               1.10-7     2024-07-23 [1] CRAN (R 4.4.0)
    presto               * 1.0.0      2025-01-28 [1] Github (immunogenomics/presto@7636b3d)
    progressr              0.15.1     2024-11-22 [1] CRAN (R 4.4.1)
    promises               1.3.2      2024-11-28 [1] CRAN (R 4.4.1)
    purrr                  1.0.2      2023-08-10 [1] CRAN (R 4.4.0)
    R6                     2.5.1      2021-08-19 [1] CRAN (R 4.4.0)
    RANN                   2.6.2      2024-08-25 [1] CRAN (R 4.4.1)
    rappdirs               0.3.3      2021-01-31 [1] CRAN (R 4.4.0)
    RColorBrewer           1.1-3      2022-04-03 [1] CRAN (R 4.4.0)
    Rcpp                 * 1.0.14     2025-01-12 [1] CRAN (R 4.4.1)
    RcppAnnoy              0.0.22     2024-01-23 [1] CRAN (R 4.4.0)
    RcppHNSW               0.6.0      2024-02-04 [1] CRAN (R 4.4.0)
    RCurl                  1.98-1.16  2024-07-11 [1] CRAN (R 4.4.0)
    readxl               * 1.4.3.9000 2024-08-04 [1] Github (tidyverse/readxl@866eff6)
    rematch2               2.1.2      2020-05-01 [1] CRAN (R 4.4.0)
    reshape2               1.4.4      2020-04-09 [1] CRAN (R 4.4.0)
    restfulr               0.0.15     2022-06-16 [1] CRAN (R 4.4.0)
    reticulate             1.40.0     2024-11-15 [1] CRAN (R 4.4.1)
    rjson                  0.2.23     2024-09-16 [1] CRAN (R 4.4.1)
 VP rlang                * 1.1.4      2025-01-17 [2] CRAN (R 4.4.1) (on disk 1.1.5)
    ROCR                   1.0-11     2020-05-02 [1] CRAN (R 4.4.0)
    rprojroot              2.0.4      2023-11-05 [1] CRAN (R 4.4.0)
    Rsamtools              2.22.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    RSpectra               0.16-2     2024-07-18 [1] CRAN (R 4.4.0)
    RSQLite                2.3.9      2024-12-03 [1] CRAN (R 4.4.1)
    rsvd                   1.0.5      2021-04-16 [1] CRAN (R 4.4.0)
    rtracklayer            1.66.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    Rtsne                  0.17       2023-12-07 [1] CRAN (R 4.4.0)
    S4Arrays               1.6.0      2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    S4Vectors            * 0.44.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    sandwich               3.1-1      2024-09-15 [1] CRAN (R 4.4.1)
    sass                   0.4.9      2024-03-15 [1] CRAN (R 4.4.0)
    ScaledMatrix           1.14.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    scales                 1.3.0      2023-11-28 [1] CRAN (R 4.4.0)
    scater                 1.34.0     2024-10-29 [1] Bioconductor 3.20 (R 4.4.1)
    scattermore            1.2        2023-06-12 [1] CRAN (R 4.4.0)
    sctransform            0.4.1      2023-10-19 [1] CRAN (R 4.4.0)
    scuttle                1.16.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    sessioninfo            1.2.2      2021-12-06 [1] CRAN (R 4.4.0)
    Seurat               * 5.1.0      2024-05-10 [1] CRAN (R 4.4.0)
    SeuratObject         * 5.0.2      2024-05-08 [1] CRAN (R 4.4.0)
    shiny                  1.9.1      2024-08-01 [1] CRAN (R 4.4.0)
    shinyWidgets           0.8.7      2024-09-23 [1] CRAN (R 4.4.1)
    SingleCellExperiment * 1.28.1     2024-11-23 [1] Bioconductor 3.20 (R 4.4.2)
    sp                   * 2.1-4      2024-04-30 [1] CRAN (R 4.4.0)
    spam                   2.11-0     2024-10-03 [1] CRAN (R 4.4.1)
    SparseArray            1.6.0      2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    SpatialExperiment    * 1.16.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    spatialLIBD          * 1.18.0     2024-11-07 [1] Bioconductor 3.20 (R 4.4.1)
    spatstat.data          3.1-4      2024-11-15 [1] CRAN (R 4.4.1)
    spatstat.explore       3.3-3      2024-10-22 [1] CRAN (R 4.4.1)
    spatstat.geom          3.3-4      2024-11-18 [1] CRAN (R 4.4.1)
    spatstat.random        3.3-2      2024-09-18 [1] CRAN (R 4.4.1)
    spatstat.sparse        3.1-0      2024-06-21 [1] CRAN (R 4.4.0)
    spatstat.univar        3.1-1      2024-11-05 [1] CRAN (R 4.4.1)
    spatstat.utils         3.1-1      2024-11-03 [1] CRAN (R 4.4.1)
    statmod                1.5.0      2023-01-06 [1] CRAN (R 4.4.0)
    stringi                1.8.4      2024-05-06 [1] CRAN (R 4.4.0)
    stringr                1.5.1      2023-11-14 [1] CRAN (R 4.4.0)
    SummarizedExperiment * 1.36.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    survival               3.7-0      2024-06-05 [1] CRAN (R 4.4.0)
    tensor                 1.5        2012-05-05 [1] CRAN (R 4.4.0)
    tibble                 3.2.1      2023-03-20 [1] CRAN (R 4.4.0)
    tidyr                  1.3.1      2024-01-24 [1] CRAN (R 4.4.0)
    tidyselect             1.2.1      2024-03-11 [1] CRAN (R 4.4.0)
    UCSC.utils             1.2.0      2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    uwot                   0.2.2      2024-04-21 [1] CRAN (R 4.4.0)
    vctrs                  0.6.5      2023-12-01 [1] CRAN (R 4.4.0)
    vipor                  0.4.7      2023-12-18 [1] CRAN (R 4.4.0)
    viridis                0.6.5      2024-01-29 [1] CRAN (R 4.4.0)
    viridisLite            0.4.2      2023-05-02 [1] CRAN (R 4.4.0)
    withr                  3.0.2      2024-10-28 [1] CRAN (R 4.4.1)
    xfun                   0.49       2024-10-31 [1] CRAN (R 4.4.1)
    XML                    3.99-0.17  2024-06-25 [1] CRAN (R 4.3.3)
    xml2                   1.3.6      2023-12-04 [1] CRAN (R 4.4.0)
    xtable                 1.8-4      2019-04-21 [1] CRAN (R 4.4.0)
    XVector                0.46.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    yaml                   2.3.10     2024-07-26 [1] CRAN (R 4.4.0)
    zlibbioc               1.52.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    zoo                    1.8-12     2023-04-13 [1] CRAN (R 4.4.0)

 [1] /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library
 [2] /Users/bmulvey/Library/R/arm64/4.4/library

 V ── Loaded and on-disk version mismatch.
 P ── Loaded and on-disk path mismatch.

───────────────────────────────────
> sessionInfo()
R version 4.4.1 RC (2024-06-06 r86719)
Platform: aarch64-apple-darwin20
Running under: macOS Sonoma 14.7.1

Matrix products: default
BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Chicago
tzcode source: internal

attached base packages:
[1] parallel  stats4    stats    
[4] graphics  grDevices utils    
[7] methods   base     

other attached packages:
 [1] spatialLIBD_1.18.0         
 [2] SpatialExperiment_1.16.0   
 [3] BiocParallel_1.40.0        
 [4] parallelly_1.40.1          
 [5] colorout_1.3-0.2           
 [6] readxl_1.4.3.9000          
 [7] presto_1.0.0               
 [8] Rcpp_1.0.14                
 [9] Seurat_5.1.0               
[10] SeuratObject_5.0.2         
[11] sp_2.1-4                   
[12] SingleCellExperiment_1.28.1
[13] SummarizedExperiment_1.36.0
[14] Biobase_2.66.0             
[15] GenomicRanges_1.58.0       
[16] GenomeInfoDb_1.42.1        
[17] IRanges_2.40.1             
[18] S4Vectors_0.44.0           
[19] BiocGenerics_0.52.0        
[20] MatrixGenerics_1.18.0      
[21] matrixStats_1.4.1          
[22] gridExtra_2.3              
[23] ggtext_0.1.2               
[24] ggplot2_3.5.1              
[25] data.table_1.16.4          
[26] rlang_1.1.4                

loaded via a namespace (and not attached):
  [1] spatstat.sparse_3.1-0   
  [2] bitops_1.0-9            
  [3] httr_1.4.7              
  [4] RColorBrewer_1.1-3      
  [5] doParallel_1.0.17       
  [6] tools_4.4.1             
  [7] sctransform_0.4.1       
  [8] R6_2.5.1                
  [9] DT_0.33                 
 [10] lazyeval_0.2.2          
 [11] uwot_0.2.2              
 [12] withr_3.0.2             
 [13] progressr_0.15.1        
 [14] cli_3.6.3               
 [15] spatstat.explore_3.3-3  
 [16] fastDummies_1.7.4       
 [17] sandwich_3.1-1          
 [18] labeling_0.4.3          
 [19] sass_0.4.9              
 [20] spatstat.data_3.1-4     
 [21] ggridges_0.5.6          
 [22] pbapply_1.7-2           
 [23] Rsamtools_2.22.0        
 [24] scater_1.34.0           
 [25] sessioninfo_1.2.2       
 [26] attempt_0.3.1           
 [27] maps_3.4.2.1            
 [28] limma_3.62.1            
 [29] RSQLite_2.3.9           
 [30] generics_0.1.3          
 [31] BiocIO_1.16.0           
 [32] ica_1.0-3               
 [33] spatstat.random_3.3-2   
 [34] dplyr_1.1.4             
 [35] Matrix_1.7-1            
 [36] ggbeeswarm_0.7.2        
 [37] abind_1.4-8             
 [38] lifecycle_1.0.4         
 [39] yaml_2.3.10             
 [40] edgeR_4.4.1             
 [41] SparseArray_1.6.0       
 [42] BiocFileCache_2.14.0    
 [43] Rtsne_0.17              
 [44] paletteer_1.6.0         
 [45] grid_4.4.1              
 [46] blob_1.2.4              
 [47] promises_1.3.2          
 [48] ExperimentHub_2.14.0    
 [49] crayon_1.5.3            
 [50] miniUI_0.1.1.1          
 [51] lattice_0.22-6          
 [52] beachmat_2.22.0         
 [53] cowplot_1.1.3           
 [54] KEGGREST_1.46.0         
 [55] magick_2.8.5            
 [56] pillar_1.10.1           
 [57] knitr_1.49              
 [58] rjson_0.2.23            
 [59] future.apply_1.11.3     
 [60] codetools_0.2-20        
 [61] leiden_0.4.3.1          
 [62] glue_1.8.0              
 [63] spatstat.univar_3.1-1   
 [64] vctrs_0.6.5             
 [65] png_0.1-8               
 [66] spam_2.11-0             
 [67] cellranger_1.1.0        
 [68] gtable_0.3.6            
 [69] rematch2_2.1.2          
 [70] cachem_1.1.0            
 [71] xfun_0.49               
 [72] S4Arrays_1.6.0          
 [73] mime_0.12               
 [74] lfe_3.1.0               
 [75] survival_3.7-0          
 [76] iterators_1.0.14        
 [77] fields_16.3             
 [78] statmod_1.5.0           
 [79] fitdistrplus_1.2-1      
 [80] ROCR_1.0-11             
 [81] nlme_3.1-166            
 [82] bit64_4.5.2             
 [83] filelock_1.0.3          
 [84] RcppAnnoy_0.0.22        
 [85] rprojroot_2.0.4         
 [86] bslib_0.8.0             
 [87] irlba_2.3.5.1           
 [88] vipor_0.4.7             
 [89] KernSmooth_2.23-24      
 [90] colorspace_2.1-1        
 [91] DBI_1.2.3               
 [92] tidyselect_1.2.1        
 [93] bit_4.5.0.1             
 [94] compiler_4.4.1          
 [95] curl_6.0.1              
 [96] BiocNeighbors_2.0.1     
 [97] xml2_1.3.6              
 [98] DelayedArray_0.32.0     
 [99] plotly_4.10.4           
[100] rtracklayer_1.66.0      
[101] scales_1.3.0            
[102] lmtest_0.9-40           
[103] rappdirs_0.3.3          
[104] stringr_1.5.1           
[105] digest_0.6.37           
[106] goftest_1.2-3           
[107] spatstat.utils_3.1-1    
[108] benchmarkmeData_1.0.4   
[109] XVector_0.46.0          
[110] htmltools_0.5.8.1       
[111] pkgconfig_2.0.3         
[112] dbplyr_2.5.0            
[113] fastmap_1.2.0           
[114] htmlwidgets_1.6.4       
[115] UCSC.utils_1.2.0        
[116] shiny_1.9.1             
[117] jquerylib_0.1.4         
[118] farver_2.1.2            
[119] zoo_1.8-12              
[120] jsonlite_1.8.9          
[121] config_0.3.2            
[122] BiocSingular_1.22.0     
[123] RCurl_1.98-1.16         
[124] magrittr_2.0.3          
[125] Formula_1.2-5           
[126] scuttle_1.16.0          
[127] GenomeInfoDbData_1.2.13 
[128] dotCall64_1.2           
[129] patchwork_1.3.0         
[130] munsell_0.5.1           
[131] viridis_0.6.5           
[132] reticulate_1.40.0       
[133] stringi_1.8.4           
[134] zlibbioc_1.52.0         
[135] MASS_7.3-61             
[136] AnnotationHub_3.14.0    
[137] plyr_1.8.9              
[138] listenv_0.9.1           
[139] ggrepel_0.9.6           
[140] deldir_2.0-4            
[141] Biostrings_2.74.0       
[142] splines_4.4.1           
[143] gridtext_0.1.5          
[144] tensor_1.5              
[145] locfit_1.5-9.10         
[146] igraph_2.1.2            
[147] spatstat.geom_3.3-4     
[148] RcppHNSW_0.6.0          
[149] ScaledMatrix_1.14.0     
[150] reshape2_1.4.4          
[151] BiocVersion_3.20.0      
[152] XML_3.99-0.17           
[153] evaluate_1.0.1          
[154] golem_0.5.1             
[155] BiocManager_1.30.25     
[156] foreach_1.5.2           
[157] httpuv_1.6.15           
[158] RANN_2.6.2              
[159] tidyr_1.3.1             
[160] purrr_1.0.2             
[161] polyclip_1.10-7         
[162] future_1.34.0           
[163] benchmarkme_1.0.8       
[164] scattermore_1.2         
[165] rsvd_1.0.5              
[166] xtable_1.8-4            
[167] restfulr_0.0.15         
[168] RSpectra_0.16-2         
[169] later_1.4.1             
[170] viridisLite_0.4.2       
[171] tibble_3.2.1            
[172] beeswarm_0.4.0          
[173] memoise_2.0.1           
[174] AnnotationDbi_1.68.0    
[175] GenomicAlignments_1.42.0
[176] cluster_2.1.8           
[177] shinyWidgets_0.8.7      
[178] globals_0.16.3          
[179] here_1.0.1              
> sessioninfo::session_info()
─ Session info ────────────────────
 setting  value
 version  R version 4.4.1 RC (2024-06-06 r86719)
 os       macOS Sonoma 14.7.1
 system   aarch64, darwin20
 ui       X11
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       America/Chicago
 date     2025-01-31
 pandoc   NA

─ Packages ────────────────────────
 !  package              * version    date (UTC) lib source
    abind                  1.4-8      2024-09-12 [1] CRAN (R 4.4.1)
    AnnotationDbi          1.68.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    AnnotationHub          3.14.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    attempt                0.3.1      2020-05-03 [1] CRAN (R 4.4.0)
    beachmat               2.22.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    beeswarm               0.4.0      2021-06-01 [1] CRAN (R 4.4.0)
    benchmarkme            1.0.8      2022-06-12 [1] CRAN (R 4.4.0)
    benchmarkmeData        1.0.4      2020-04-23 [1] CRAN (R 4.4.0)
    Biobase              * 2.66.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    BiocFileCache          2.14.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    BiocGenerics         * 0.52.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    BiocIO                 1.16.0     2024-12-12 [1] Github (Bioconductor/BiocIO@8e80624)
    BiocManager            1.30.25    2024-08-28 [1] CRAN (R 4.4.1)
    BiocNeighbors          2.0.1      2024-11-28 [1] Bioconductor 3.20 (R 4.4.2)
    BiocParallel         * 1.40.0     2024-11-23 [1] Bioconductor 3.20 (R 4.4.2)
    BiocSingular           1.22.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    BiocVersion            3.20.0     2024-05-04 [1] Bioconductor 3.20 (R 4.4.0)
    Biostrings             2.74.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    bit                    4.5.0.1    2024-12-03 [1] CRAN (R 4.4.1)
    bit64                  4.5.2      2024-09-22 [1] CRAN (R 4.4.1)
    bitops                 1.0-9      2024-10-03 [1] CRAN (R 4.4.1)
    blob                   1.2.4      2023-03-17 [1] CRAN (R 4.4.0)
    bslib                  0.8.0      2024-07-29 [1] CRAN (R 4.4.0)
    cachem                 1.1.0      2024-05-16 [1] CRAN (R 4.4.0)
    cellranger             1.1.0      2016-07-27 [1] CRAN (R 4.4.0)
 P  cli                    3.6.3      2024-06-21 [2] CRAN (R 4.4.0)
    cluster                2.1.8      2024-12-11 [1] CRAN (R 4.4.1)
    codetools              0.2-20     2024-03-31 [1] CRAN (R 4.4.1)
    colorout             * 1.3-0.2    2024-05-01 [1] Github (jalvesaq/colorout@c6113a2)
    colorspace             2.1-1      2024-07-26 [1] CRAN (R 4.4.0)
    config                 0.3.2      2023-08-30 [1] CRAN (R 4.4.0)
    cowplot                1.1.3      2024-01-22 [1] CRAN (R 4.4.0)
    crayon                 1.5.3      2024-06-20 [1] CRAN (R 4.4.0)
    curl                   6.0.1      2024-11-14 [1] CRAN (R 4.4.1)
    data.table           * 1.16.4     2024-12-06 [1] CRAN (R 4.4.1)
    DBI                    1.2.3      2024-06-02 [1] CRAN (R 4.4.0)
    dbplyr                 2.5.0      2024-03-19 [1] CRAN (R 4.4.0)
    DelayedArray           0.32.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    deldir                 2.0-4      2024-02-28 [1] CRAN (R 4.4.0)
    digest                 0.6.37     2024-08-19 [1] CRAN (R 4.4.1)
    doParallel             1.0.17     2022-02-07 [1] CRAN (R 4.4.1)
    dotCall64              1.2        2024-10-04 [1] CRAN (R 4.4.1)
    dplyr                  1.1.4      2023-11-17 [1] CRAN (R 4.4.0)
    DT                     0.33       2024-04-04 [1] CRAN (R 4.4.0)
    edgeR                  4.4.1      2024-12-02 [1] Bioconductor 3.20 (R 4.4.2)
    evaluate               1.0.1      2024-10-10 [1] CRAN (R 4.4.1)
    ExperimentHub          2.14.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    farver                 2.1.2      2024-05-13 [1] CRAN (R 4.4.0)
    fastDummies            1.7.4      2024-08-16 [1] CRAN (R 4.4.0)
    fastmap                1.2.0      2024-05-15 [1] CRAN (R 4.4.0)
    fields                 16.3       2024-09-30 [1] CRAN (R 4.4.1)
    filelock               1.0.3      2023-12-11 [1] CRAN (R 4.4.0)
    fitdistrplus           1.2-1      2024-07-12 [1] CRAN (R 4.4.0)
    foreach                1.5.2      2022-02-02 [1] CRAN (R 4.4.0)
    Formula                1.2-5      2023-02-24 [1] CRAN (R 4.4.0)
    future                 1.34.0     2024-07-29 [1] CRAN (R 4.4.0)
    future.apply           1.11.3     2024-10-27 [1] CRAN (R 4.4.1)
    generics               0.1.3      2022-07-05 [1] CRAN (R 4.4.0)
    GenomeInfoDb         * 1.42.1     2024-11-28 [1] Bioconductor 3.20 (R 4.4.2)
    GenomeInfoDbData       1.2.13     2024-12-12 [1] Bioconductor
    GenomicAlignments      1.42.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    GenomicRanges        * 1.58.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    ggbeeswarm             0.7.2      2023-04-29 [1] CRAN (R 4.4.0)
    ggplot2              * 3.5.1      2024-04-23 [1] CRAN (R 4.4.0)
    ggrepel                0.9.6      2024-09-07 [1] CRAN (R 4.4.1)
    ggridges               0.5.6      2024-01-23 [1] CRAN (R 4.4.0)
    ggtext               * 0.1.2      2022-09-16 [1] CRAN (R 4.4.0)
    globals                0.16.3     2024-03-08 [1] CRAN (R 4.4.0)
    glue                   1.8.0      2024-09-30 [1] CRAN (R 4.4.1)
    goftest                1.2-3      2021-10-07 [1] CRAN (R 4.4.0)
    golem                  0.5.1      2024-08-27 [1] CRAN (R 4.4.1)
    gridExtra            * 2.3        2017-09-09 [1] CRAN (R 4.4.0)
    gridtext               0.1.5      2022-09-16 [1] CRAN (R 4.4.0)
    gtable                 0.3.6      2024-10-25 [1] CRAN (R 4.4.1)
    here                   1.0.1      2020-12-13 [1] CRAN (R 4.4.0)
    htmltools              0.5.8.1    2024-04-04 [1] CRAN (R 4.4.0)
    htmlwidgets            1.6.4      2023-12-06 [1] CRAN (R 4.4.0)
    httpuv                 1.6.15     2024-03-26 [1] CRAN (R 4.4.0)
    httr                   1.4.7      2023-08-15 [1] CRAN (R 4.4.0)
    ica                    1.0-3      2022-07-08 [1] CRAN (R 4.4.0)
    igraph                 2.1.2      2024-12-07 [1] CRAN (R 4.4.1)
    IRanges              * 2.40.1     2024-12-05 [1] Bioconductor 3.20 (R 4.4.2)
    irlba                  2.3.5.1    2022-10-03 [1] CRAN (R 4.4.0)
    iterators              1.0.14     2022-02-05 [1] CRAN (R 4.4.0)
    jquerylib              0.1.4      2021-04-26 [1] CRAN (R 4.4.0)
    jsonlite               1.8.9      2024-09-20 [1] CRAN (R 4.4.1)
    KEGGREST               1.46.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    KernSmooth             2.23-24    2024-05-17 [1] CRAN (R 4.4.1)
    knitr                  1.49       2024-11-08 [1] CRAN (R 4.4.1)
    labeling               0.4.3      2023-08-29 [1] CRAN (R 4.4.0)
    later                  1.4.1      2024-11-27 [1] CRAN (R 4.4.1)
    lattice                0.22-6     2024-03-20 [1] CRAN (R 4.4.1)
    lazyeval               0.2.2      2019-03-15 [1] CRAN (R 4.4.0)
    leiden                 0.4.3.1    2023-11-17 [1] CRAN (R 4.4.0)
    lfe                    3.1.0      2024-11-06 [1] CRAN (R 4.4.1)
    lifecycle              1.0.4      2023-11-07 [1] CRAN (R 4.4.0)
    limma                  3.62.1     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    listenv                0.9.1      2024-01-29 [1] CRAN (R 4.4.0)
    lmtest                 0.9-40     2022-03-21 [1] CRAN (R 4.4.0)
    locfit                 1.5-9.10   2024-06-24 [1] CRAN (R 4.4.0)
    magick                 2.8.5      2024-09-20 [1] CRAN (R 4.4.1)
    magrittr               2.0.3      2022-03-30 [1] CRAN (R 4.4.0)
    maps                   3.4.2.1    2024-11-10 [1] CRAN (R 4.4.1)
    MASS                   7.3-61     2024-06-13 [1] CRAN (R 4.4.0)
    Matrix                 1.7-1      2024-10-18 [1] CRAN (R 4.4.1)
    MatrixGenerics       * 1.18.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    matrixStats          * 1.4.1      2024-09-08 [1] CRAN (R 4.4.1)
    memoise                2.0.1      2021-11-26 [1] CRAN (R 4.4.0)
    mime                   0.12       2021-09-28 [1] CRAN (R 4.4.0)
    miniUI                 0.1.1.1    2018-05-18 [1] CRAN (R 4.4.0)
    munsell                0.5.1      2024-04-01 [1] CRAN (R 4.4.0)
    nlme                   3.1-166    2024-08-14 [1] CRAN (R 4.4.0)
    paletteer              1.6.0      2024-01-21 [1] CRAN (R 4.4.0)
    parallelly           * 1.40.1     2024-12-04 [1] CRAN (R 4.4.1)
    patchwork              1.3.0      2024-09-16 [1] CRAN (R 4.4.1)
    pbapply                1.7-2      2023-06-27 [1] CRAN (R 4.4.0)
    pillar                 1.10.1     2025-01-07 [1] CRAN (R 4.4.1)
    pkgconfig              2.0.3      2019-09-22 [1] CRAN (R 4.4.0)
    plotly                 4.10.4     2024-01-13 [1] CRAN (R 4.4.0)
    plyr                   1.8.9      2023-10-02 [1] CRAN (R 4.4.0)
    png                    0.1-8      2022-11-29 [1] CRAN (R 4.4.0)
    polyclip               1.10-7     2024-07-23 [1] CRAN (R 4.4.0)
    presto               * 1.0.0      2025-01-28 [1] Github (immunogenomics/presto@7636b3d)
    progressr              0.15.1     2024-11-22 [1] CRAN (R 4.4.1)
    promises               1.3.2      2024-11-28 [1] CRAN (R 4.4.1)
    purrr                  1.0.2      2023-08-10 [1] CRAN (R 4.4.0)
    R6                     2.5.1      2021-08-19 [1] CRAN (R 4.4.0)
    RANN                   2.6.2      2024-08-25 [1] CRAN (R 4.4.1)
    rappdirs               0.3.3      2021-01-31 [1] CRAN (R 4.4.0)
    RColorBrewer           1.1-3      2022-04-03 [1] CRAN (R 4.4.0)
    Rcpp                 * 1.0.14     2025-01-12 [1] CRAN (R 4.4.1)
    RcppAnnoy              0.0.22     2024-01-23 [1] CRAN (R 4.4.0)
    RcppHNSW               0.6.0      2024-02-04 [1] CRAN (R 4.4.0)
    RCurl                  1.98-1.16  2024-07-11 [1] CRAN (R 4.4.0)
    readxl               * 1.4.3.9000 2024-08-04 [1] Github (tidyverse/readxl@866eff6)
    rematch2               2.1.2      2020-05-01 [1] CRAN (R 4.4.0)
    reshape2               1.4.4      2020-04-09 [1] CRAN (R 4.4.0)
    restfulr               0.0.15     2022-06-16 [1] CRAN (R 4.4.0)
    reticulate             1.40.0     2024-11-15 [1] CRAN (R 4.4.1)
    rjson                  0.2.23     2024-09-16 [1] CRAN (R 4.4.1)
 VP rlang                * 1.1.4      2025-01-17 [2] CRAN (R 4.4.1) (on disk 1.1.5)
    ROCR                   1.0-11     2020-05-02 [1] CRAN (R 4.4.0)
    rprojroot              2.0.4      2023-11-05 [1] CRAN (R 4.4.0)
    Rsamtools              2.22.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    RSpectra               0.16-2     2024-07-18 [1] CRAN (R 4.4.0)
    RSQLite                2.3.9      2024-12-03 [1] CRAN (R 4.4.1)
    rsvd                   1.0.5      2021-04-16 [1] CRAN (R 4.4.0)
    rtracklayer            1.66.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    Rtsne                  0.17       2023-12-07 [1] CRAN (R 4.4.0)
    S4Arrays               1.6.0      2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    S4Vectors            * 0.44.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    sandwich               3.1-1      2024-09-15 [1] CRAN (R 4.4.1)
    sass                   0.4.9      2024-03-15 [1] CRAN (R 4.4.0)
    ScaledMatrix           1.14.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    scales                 1.3.0      2023-11-28 [1] CRAN (R 4.4.0)
    scater                 1.34.0     2024-10-29 [1] Bioconductor 3.20 (R 4.4.1)
    scattermore            1.2        2023-06-12 [1] CRAN (R 4.4.0)
    sctransform            0.4.1      2023-10-19 [1] CRAN (R 4.4.0)
    scuttle                1.16.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    sessioninfo            1.2.2      2021-12-06 [1] CRAN (R 4.4.0)
    Seurat               * 5.1.0      2024-05-10 [1] CRAN (R 4.4.0)
    SeuratObject         * 5.0.2      2024-05-08 [1] CRAN (R 4.4.0)
    shiny                  1.9.1      2024-08-01 [1] CRAN (R 4.4.0)
    shinyWidgets           0.8.7      2024-09-23 [1] CRAN (R 4.4.1)
    SingleCellExperiment * 1.28.1     2024-11-23 [1] Bioconductor 3.20 (R 4.4.2)
    sp                   * 2.1-4      2024-04-30 [1] CRAN (R 4.4.0)
    spam                   2.11-0     2024-10-03 [1] CRAN (R 4.4.1)
    SparseArray            1.6.0      2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    SpatialExperiment    * 1.16.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    spatialLIBD          * 1.18.0     2024-11-07 [1] Bioconductor 3.20 (R 4.4.1)
    spatstat.data          3.1-4      2024-11-15 [1] CRAN (R 4.4.1)
    spatstat.explore       3.3-3      2024-10-22 [1] CRAN (R 4.4.1)
    spatstat.geom          3.3-4      2024-11-18 [1] CRAN (R 4.4.1)
    spatstat.random        3.3-2      2024-09-18 [1] CRAN (R 4.4.1)
    spatstat.sparse        3.1-0      2024-06-21 [1] CRAN (R 4.4.0)
    spatstat.univar        3.1-1      2024-11-05 [1] CRAN (R 4.4.1)
    spatstat.utils         3.1-1      2024-11-03 [1] CRAN (R 4.4.1)
    statmod                1.5.0      2023-01-06 [1] CRAN (R 4.4.0)
    stringi                1.8.4      2024-05-06 [1] CRAN (R 4.4.0)
    stringr                1.5.1      2023-11-14 [1] CRAN (R 4.4.0)
    SummarizedExperiment * 1.36.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    survival               3.7-0      2024-06-05 [1] CRAN (R 4.4.0)
    tensor                 1.5        2012-05-05 [1] CRAN (R 4.4.0)
    tibble                 3.2.1      2023-03-20 [1] CRAN (R 4.4.0)
    tidyr                  1.3.1      2024-01-24 [1] CRAN (R 4.4.0)
    tidyselect             1.2.1      2024-03-11 [1] CRAN (R 4.4.0)
    UCSC.utils             1.2.0      2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    uwot                   0.2.2      2024-04-21 [1] CRAN (R 4.4.0)
    vctrs                  0.6.5      2023-12-01 [1] CRAN (R 4.4.0)
    vipor                  0.4.7      2023-12-18 [1] CRAN (R 4.4.0)
    viridis                0.6.5      2024-01-29 [1] CRAN (R 4.4.0)
    viridisLite            0.4.2      2023-05-02 [1] CRAN (R 4.4.0)
    withr                  3.0.2      2024-10-28 [1] CRAN (R 4.4.1)
    xfun                   0.49       2024-10-31 [1] CRAN (R 4.4.1)
    XML                    3.99-0.17  2024-06-25 [1] CRAN (R 4.3.3)
    xml2                   1.3.6      2023-12-04 [1] CRAN (R 4.4.0)
    xtable                 1.8-4      2019-04-21 [1] CRAN (R 4.4.0)
    XVector                0.46.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    yaml                   2.3.10     2024-07-26 [1] CRAN (R 4.4.0)
    zlibbioc               1.52.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    zoo                    1.8-12     2023-04-13 [1] CRAN (R 4.4.0)

 [1] /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library
 [2] /Users/bmulvey/Library/R/arm64/4.4/library

 V ── Loaded and on-disk version mismatch.
 P ── Loaded and on-disk path mismatch.
