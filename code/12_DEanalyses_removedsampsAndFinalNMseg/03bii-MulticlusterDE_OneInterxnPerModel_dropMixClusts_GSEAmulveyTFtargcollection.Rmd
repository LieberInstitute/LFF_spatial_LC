---
title: "03bii-MulticlusterDE_OneInterxnPerModel_dropMixClusts_GSEAmulveyTFtargcollection"
author: "Bernie Mulvey"
date: "2025-05-24"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.height = 10,fig.width = 7,include = FALSE)
knitr::opts_chunk$set(fig.width=7,fig.height=10)
#### sets tab autocompletion for directories to begin from the directory containing the .Rproj session, instead of the script's directory if different
knitr::opts_knit$set(root.dir = here::here())

library(data.table)
library(clusterProfiler) # otherwise fgsea parallelization doesnt seem to work
library(fgsea)
library(SpatialExperiment)

require(colorout)
ColorOut()
options("styler.addins_style_transformer" = "biocthis::bioc_style()")

## change write.table to output a TSV without quotes or rownames by default
library(default)
default(write.table) <- list(row.names=F,col.names=T,sep='\t',quote=F)

## enable forked parallel processing with BiocParallel::multicoreParam, future::, etc
library(parallel)
options(parallelly.supportsMulticore.disableOn="")
options(parallelly.fork.enable=TRUE)
library(parallelly)
options(bphost="localhost")
library(BiocParallel)
```

### use TF-target sets compiled from enrichr sets on 12/18/23 (same RDS file as used for mulvey hypothalamus sex diffs). preformatted for fgsea.
```{r}
sets <- readRDS("raw-data/ref_data/00a-enrichrTFsets_forfgseainput_121823.RDS")
```


# PART 1: get signed DE t stat vectors per cluster per test
```{r}
## need to use gene symbols for compatibility with the TF-target sets
lc3 <- readRDS("processed-data/06-countsOnly_noImgData_QCed_SPE_split_to_tissSections.RDS")
rddt <- as.data.table(rowData(lc3))
rm(lc3)

de2b <- readRDS("processed-data/12_DEanalyses_removedsampsAndFinalNMseg/02b-voomLmFit_objs_and_DE_tables_LabSex_LabE2vE4_LabSingleGenos_LabAncesGrp_noMixClusts.RDS")

de2b <- lapply(de2b,FUN=function(x){x[[6]]})
de2b2 <- list()
i<-1
for (i in c(1:length(de2b))){
    j<-1
    for (j in c(1:length(de2b[[i]]))){
        de2b2[length(de2b2)+1] <- de2b[[i]][j]
        names(de2b2)[length(de2b2)] <- names(de2b[[i]])[j]
    }
    rm(j)
}
rm(i)

### drop sex chr genes from sex DE tests
de2b2[grep(names(de2b2),pattern="sex",value=T)] <- lapply(de2b2[grep(names(de2b2),pattern="sex",value=T)],FUN=function(x){
    x[!(chr %in% grep(chr,pattern="chrX|chrY",value=T))]})

### drop mito genes from all tests
de2b2 <- lapply(de2b2,FUN=function(x){
    x[!(chr %in% grep(chr,pattern="chrMT",value=T))]})

### get named, SIGNED vectors of DE t-stats from each test
deres <- list()
i<-1
for (i in c(1:length(de2b2))){
    setnames(de2b2[[i]],"t","tstat")
    tmp <- copy(de2b2[[i]])[,.(gene_id,tstat)]
    setorderv(tmp,"tstat",-1)
    ## get the stat column as a vector and give it the gene ids as names for fgsea
    ## note that since data.table (invisibly) uses list() for column data, its cleaner to just make the working table a data frame for this last bit
    tmp <- as.data.frame(tmp)
    v <- tmp$tstat
    names(v) <- tmp$gene_id
    deres[[length(deres)+1]] <- v
    names(deres)[length(deres)] <- names(de2b2)[i]
    rm(v,tmp)
}
rm(i,de2b)
gc(full=T)
```

### run fgsea-signed tests
### looping through each cluster-variable interaction (each run is very fast with 10 cpus in biocparallel, so just serially run 10cpu GSEA for each cluster)

```{r}
tfgseares <- mapply(X=deres,Y=names(deres),SIMPLIFY=FALSE,FUN=function(X,Y){
   register(MulticoreParam())
   
   # get cond1-up enriched results
   z1<-fgseaMultilevel(pathways=sets,stats = X,minSize = 15,maxSize = 500,eps=0.0,nPermSimple = 50000,nproc=10,scoreType = "pos")
   # coonvert leadingedge to one long string (it's returned as a list which is not compatible with data.table)
   z1$leadingEdge <- as.character(z1$leadingEdge)
   z1$leadingEdge <- gsub(z1$leadingEdge,pattern="^c\\((.*)\\)$",replacement="\\1")
   z1$leadingEdge <- gsub(z1$leadingEdge,pattern='"',replacement='')
   
   # drop newlines from leadingEdge
   z1$leadingEdge <- gsub(z1$leadingEdge,pattern=", \n",replacement=", ")
   # somehow, one run of this sometimes doesnt get them all so repeat for good meas
   z1$leadingEdge <- gsub(z1$leadingEdge,pattern=", \n",replacement=", ")
   
   z1 <- as.data.table(z1)
   z1[,test:=Y]
   
   if(length(grep(Y,pattern="Sex",value=T))>0){
       z1[,dir:="male_up"]
   } else if(length(grep(Y,pattern="E4vE2",value=T))>0){
       z1[,dir:="E4carriers_up"]
   } else if(length(grep(Y,pattern="YRI",value=T))>0){
       z1[,dir:="YRI_up"]
   } else {
       z1[,dir:=gsub(Y,pattern="^.*_(E....)_vs_(.*)",replacement=paste0("\\1","_up_vs_","\\2"))]
   }
   
   # get cond2-up enriched results
   register(MulticoreParam())
   z2<-fgseaMultilevel(pathways=sets,stats = X,minSize = 15,maxSize = 500,eps=0.0,nPermSimple = 50000,nproc=10,scoreType = "neg")
   # coonvert leadingedge to one long string (it's returned as a list which is not compatible with data.table)
   z2$leadingEdge <- as.character(z2$leadingEdge)
   z2$leadingEdge <- gsub(z2$leadingEdge,pattern="^c\\((.*)\\)$",replacement="\\1")
   z2$leadingEdge <- gsub(z2$leadingEdge,pattern='"',replacement='')
   
   # drop newlines from leadingEdge
   z2$leadingEdge <- gsub(z2$leadingEdge,pattern=", \n",replacement=", ")
   # somehow, one run of this sometimes doesnt get them all so repeat for good meas
   z2$leadingEdge <- gsub(z2$leadingEdge,pattern=", \n",replacement=", ")
   
   z2 <- as.data.table(z2)
   z2[,test:=Y]
   
    if(length(grep(Y,pattern="Sex",value=T))>0){
       z2[,dir:="female_up"]
   } else if(length(grep(Y,pattern="E4vE2",value=T))>0){
       z2[,dir:="E4carriers_down"]
   } else if(length(grep(Y,pattern="YRI",value=T))>0){
       z2[,dir:="YRI_down"]
   } else {
       z2[,dir:=gsub(Y,pattern="^.*_(E....)_vs_(.*)",replacement=paste0("\\1","_down_vs_","\\2"))]
   }
   
   z<- as.data.table(rbind(z1,z2))
   return(z)
})
names(tfgseares) <- names(deres)

saveRDS(tfgseares,"processed-data/12_DEanalyses_removedsampsAndFinalNMseg/03bii-MulticlusterDE_OneInterxnPerModel_dropMixClusts_GSEA_TFtargs.RDS")

rm(deres,tfgseares)
```


### PART 2: get UNsigned DE t stat vectors per cluster per test
```{r}
### get named, UNsigned vectors of DE t-stats from each test
deres <- list()
i<-1
for (i in c(1:length(de2b2))){
    tmp <- copy(de2b2[[i]])[,.(gene_id,abs(tstat))]
    tmp <- merge.data.table(tmp,rddt[,.(gene_id,gene_name)],by="gene_id",all.x=T)
    
    dropg <- tmp[,.N,by="gene_id"][N>1,gene_id]
    dropg2 <- tmp[,.N,by="gene_name"][N>1,gene_name]
    tmp <- tmp[!(gene_id %in% dropg)&!(gene_name %in% dropg2)]
    
    setnames(tmp,2,"tstat")
    setorderv(tmp,"tstat",-1)
    ## get the stat column as a vector and give it the gene ids as names for fgsea
    ## note that since data.table (invisibly) uses list() for column data, its cleaner to just make the working table a data frame for this last bit
    tmp <- as.data.frame(tmp)
    v <- tmp$tstat
    names(v) <- tmp$gene_name
    deres[[length(deres)+1]] <- v
    names(deres)[length(deres)] <- names(de2b2)[i]
    rm(v,tmp)
}
rm(i,de2b)
```

run UNSIGNED fgsea (genes that tend to be affected, regardless of direction)
```{r}
tfgseares.unsign <- mapply(X=deres,Y=names(deres),SIMPLIFY=FALSE,FUN=function(X,Y){
   register(MulticoreParam())
   
   # get DE-enriched results
   z1<-fgseaMultilevel(pathways=sets,stats = X,minSize = 15,maxSize = 500,eps=0.0,nPermSimple = 50000,nproc=10,scoreType = "pos")
   
   # coonvert leadingedge to one long string (it's returned as a list which is not compatible with data.table)
   z1$leadingEdge <- as.character(z1$leadingEdge)
   z1$leadingEdge <- gsub(z1$leadingEdge,pattern="^c\\((.*)\\)$",replacement="\\1")
   z1$leadingEdge <- gsub(z1$leadingEdge,pattern='"',replacement='')
   # drop newlines from leadingEdge
   z1$leadingEdge <- gsub(z1$leadingEdge,pattern=", \n",replacement=", ")
   # belt and suspenders
   z1$leadingEdge <- gsub(z1$leadingEdge,pattern=", \n",replacement=", ")
   
   z1 <- as.data.table(z1)
   z1[,test:=Y]
   z1[,dir:="either"]
   
   return(z1)
})

names(tfgseares.unsign) <- names(deres)

saveRDS(tfgseares.unsign,"processed-data/12_DEanalyses_removedsampsAndFinalNMseg/03bii-MulticlusterDE_OneInterxnPerModel_dropMixClusts_GSEA_TFtargs_UNsigned.RDS")
```

In a subsequent script, we will determine TFs that are at least marginally expressed in a cluster and subset each result set for that cluster accordingly.

rep inf
```{r}
sessionInfo()
sessioninfo::session_info()
```
R version 4.4.3 (2025-02-28)
Platform: aarch64-apple-darwin20
Running under: macOS Sequoia 15.3.2

Matrix products: default
BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Chicago
tzcode source: internal

attached base packages:
[1] parallel  stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] BiocParallel_1.40.0    parallelly_1.43.0      default_1.0.0         
[4] colorout_1.3-0.2       msigdbr_10.0.1         fgsea_1.32.4          
[7] clusterProfiler_4.14.6 data.table_1.17.0      rlang_1.1.5           

loaded via a namespace (and not attached):
  [1] DBI_1.2.3               gson_0.1.0              magrittr_2.0.3         
  [4] DOSE_4.0.0              compiler_4.4.3          RSQLite_2.3.9          
  [7] png_0.1-8               vctrs_0.6.5             reshape2_1.4.4         
 [10] stringr_1.5.1           pkgconfig_2.0.3         crayon_1.5.3           
 [13] fastmap_1.2.0           XVector_0.46.0          rmarkdown_2.29         
 [16] sessioninfo_1.2.3       tzdb_0.5.0              enrichplot_1.26.6      
 [19] UCSC.utils_1.2.0        purrr_1.0.4             bit_4.6.0              
 [22] xfun_0.52               zlibbioc_1.52.0         cachem_1.1.0           
 [25] aplot_0.2.5             GenomeInfoDb_1.42.3     jsonlite_2.0.0         
 [28] blob_1.2.4              R6_2.6.1                stringi_1.8.7          
 [31] RColorBrewer_1.1-3      msigdbdf_24.1.1         GOSemSim_2.32.0        
 [34] assertthat_0.2.1        Rcpp_1.0.14             knitr_1.50             
 [37] ggtangle_0.0.6          R.utils_2.13.0          readr_2.1.5            
 [40] IRanges_2.40.1          Matrix_1.7-3            splines_4.4.3          
 [43] igraph_2.1.4            tidyselect_1.2.1        qvalue_2.38.0          
 [46] rstudioapi_0.17.1       dichromat_2.0-0.1       yaml_2.3.10            
 [49] codetools_0.2-20        lattice_0.22-6          tibble_3.2.1           
 [52] plyr_1.8.9              withr_3.0.2             Biobase_2.66.0         
 [55] treeio_1.30.0           KEGGREST_1.46.0         evaluate_1.0.3         
 [58] gridGraphics_0.5-1      Biostrings_2.74.1       pillar_1.10.2          
 [61] ggtree_3.14.0           stats4_4.4.3            ggfun_0.1.8            
 [64] generics_0.1.3          rprojroot_2.0.4         hms_1.1.3              
 [67] S4Vectors_0.44.0        ggplot2_3.5.2           scales_1.4.0           
 [70] tidytree_0.4.6          glue_1.8.0              lazyeval_0.2.2         
 [73] tools_4.4.3             babelgene_22.9          fs_1.6.6               
 [76] fastmatch_1.1-6         cowplot_1.1.3           grid_4.4.3             
 [79] tidyr_1.3.1             ape_5.8-1               AnnotationDbi_1.68.0   
 [82] colorspace_2.1-1        nlme_3.1-167            GenomeInfoDbData_1.2.13
 [85] patchwork_1.3.0         cli_3.6.4               dplyr_1.1.4            
 [88] gtable_0.3.6            R.methodsS3_1.8.2       yulab.utils_0.2.0      
 [91] digest_0.6.37           BiocGenerics_0.52.0     ggrepel_0.9.6          
 [94] ggplotify_0.1.2         farver_2.1.2            memoise_2.0.1          
 [97] htmltools_0.5.8.1       R.oo_1.27.0             lifecycle_1.0.4        
[100] httr_1.4.7              here_1.0.1              GO.db_3.20.0           
[103] bit64_4.6.0-1          
> sessioninfo::session_info()
─ Session info ────────────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.4.3 (2025-02-28)
 os       macOS Sequoia 15.3.2
 system   aarch64, darwin20
 ui       RStudio
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       America/Chicago
 date     2025-05-16
 rstudio  2024.07.0-daily+219 Cranberry Hibiscus (desktop)
 pandoc   3.1.11 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/aarch64/ (via rmarkdown)
 quarto   1.4.555 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/quarto

─ Packages ────────────────────────────────────────────────────────────────────────
 !  package          * version date (UTC) lib source
    AnnotationDbi      1.68.0  2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    ape                5.8-1   2024-12-16 [1] CRAN (R 4.4.1)
    aplot              0.2.5   2025-02-27 [1] CRAN (R 4.4.1)
    assertthat         0.2.1   2019-03-21 [1] CRAN (R 4.4.0)
    babelgene          22.9    2022-09-29 [1] CRAN (R 4.4.0)
    Biobase            2.66.0  2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    BiocGenerics       0.52.0  2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    BiocParallel     * 1.40.0  2024-11-23 [1] Bioconductor 3.20 (R 4.4.2)
    Biostrings         2.74.1  2024-12-16 [1] Bioconductor 3.20 (R 4.4.2)
    bit                4.6.0   2025-03-06 [1] CRAN (R 4.4.1)
    bit64              4.6.0-1 2025-01-16 [1] CRAN (R 4.4.1)
    blob               1.2.4   2023-03-17 [1] CRAN (R 4.4.0)
    cachem             1.1.0   2024-05-16 [1] CRAN (R 4.4.0)
 VP cli                3.6.4   2025-04-23 [2] CRAN (R 4.4.1) (on disk 3.6.5)
    clusterProfiler  * 4.14.6  2025-02-27 [1] Bioconductor 3.20 (R 4.4.2)
    codetools          0.2-20  2024-03-31 [1] CRAN (R 4.4.3)
    colorout         * 1.3-0.2 2024-05-01 [1] Github (jalvesaq/colorout@c6113a2)
    colorspace         2.1-1   2024-07-26 [1] CRAN (R 4.4.0)
    cowplot            1.1.3   2024-01-22 [1] CRAN (R 4.4.0)
    crayon             1.5.3   2024-06-20 [1] CRAN (R 4.4.0)
    data.table       * 1.17.0  2025-02-22 [1] CRAN (R 4.4.1)
    DBI                1.2.3   2024-06-02 [1] CRAN (R 4.4.0)
    default          * 1.0.0   2017-08-07 [1] CRAN (R 4.4.0)
    dichromat          2.0-0.1 2022-05-02 [1] CRAN (R 4.4.0)
    digest             0.6.37  2024-08-19 [1] CRAN (R 4.4.1)
    DOSE               4.0.0   2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    dplyr              1.1.4   2023-11-17 [1] CRAN (R 4.4.0)
    enrichplot         1.26.6  2025-01-09 [1] Bioconductor 3.20 (R 4.4.2)
    evaluate           1.0.3   2025-01-10 [1] CRAN (R 4.4.1)
    farver             2.1.2   2024-05-13 [1] CRAN (R 4.4.0)
    fastmap            1.2.0   2024-05-15 [1] CRAN (R 4.4.0)
    fastmatch          1.1-6   2024-12-23 [1] CRAN (R 4.4.1)
    fgsea            * 1.32.4  2025-03-20 [1] Bioconductor 3.20 (R 4.4.3)
    fs                 1.6.6   2025-04-12 [1] CRAN (R 4.4.1)
    generics           0.1.3   2022-07-05 [1] CRAN (R 4.4.0)
    GenomeInfoDb       1.42.3  2025-01-27 [1] Bioconductor 3.20 (R 4.4.2)
    GenomeInfoDbData   1.2.13  2024-12-12 [1] Bioconductor
    ggfun              0.1.8   2024-12-03 [1] CRAN (R 4.4.1)
    ggplot2            3.5.2   2025-04-09 [1] CRAN (R 4.4.1)
    ggplotify          0.1.2   2023-08-09 [1] CRAN (R 4.4.0)
    ggrepel            0.9.6   2024-09-07 [1] CRAN (R 4.4.1)
    ggtangle           0.0.6   2024-12-18 [1] CRAN (R 4.4.1)
    ggtree             3.14.0  2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    glue               1.8.0   2024-09-30 [1] CRAN (R 4.4.1)
    GO.db              3.20.0  2024-12-12 [1] Bioconductor
    GOSemSim           2.32.0  2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    gridGraphics       0.5-1   2020-12-13 [1] CRAN (R 4.4.0)
    gson               0.1.0   2023-03-07 [1] CRAN (R 4.4.0)
    gtable             0.3.6   2024-10-25 [1] CRAN (R 4.4.1)
    here               1.0.1   2020-12-13 [1] CRAN (R 4.4.0)
    hms                1.1.3   2023-03-21 [1] CRAN (R 4.4.0)
    htmltools          0.5.8.1 2024-04-04 [1] CRAN (R 4.4.0)
    httr               1.4.7   2023-08-15 [1] CRAN (R 4.4.0)
    igraph             2.1.4   2025-01-23 [1] CRAN (R 4.4.1)
    IRanges            2.40.1  2024-12-05 [1] Bioconductor 3.20 (R 4.4.2)
    jsonlite           2.0.0   2025-03-27 [1] CRAN (R 4.4.1)
    KEGGREST           1.46.0  2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    knitr              1.50    2025-03-16 [1] CRAN (R 4.4.2)
    lattice            0.22-6  2024-03-20 [1] CRAN (R 4.4.3)
    lazyeval           0.2.2   2019-03-15 [1] CRAN (R 4.4.0)
    lifecycle          1.0.4   2023-11-07 [1] CRAN (R 4.4.0)
    magrittr           2.0.3   2022-03-30 [1] CRAN (R 4.4.0)
    Matrix             1.7-3   2025-03-11 [1] CRAN (R 4.4.1)
    memoise            2.0.1   2021-11-26 [1] CRAN (R 4.4.0)
    msigdbdf           24.1.1  2025-04-16 [1] https://igordot.r-universe.dev (R 4.4.3)
    msigdbr          * 10.0.1  2025-03-19 [1] CRAN (R 4.4.3)
    nlme               3.1-167 2025-01-27 [1] CRAN (R 4.4.3)
    parallelly       * 1.43.0  2025-03-24 [1] CRAN (R 4.4.1)
    patchwork          1.3.0   2024-09-16 [1] CRAN (R 4.4.1)
    pillar             1.10.2  2025-04-05 [1] CRAN (R 4.4.1)
    pkgconfig          2.0.3   2019-09-22 [1] CRAN (R 4.4.0)
    plyr               1.8.9   2023-10-02 [1] CRAN (R 4.4.0)
    png                0.1-8   2022-11-29 [1] CRAN (R 4.4.0)
    purrr              1.0.4   2025-02-05 [1] CRAN (R 4.4.1)
    qvalue             2.38.0  2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    R.methodsS3        1.8.2   2022-06-13 [1] CRAN (R 4.4.0)
    R.oo               1.27.0  2024-11-01 [1] CRAN (R 4.4.1)
    R.utils            2.13.0  2025-02-24 [1] CRAN (R 4.4.1)
    R6                 2.6.1   2025-02-15 [1] CRAN (R 4.4.1)
    RColorBrewer       1.1-3   2022-04-03 [1] CRAN (R 4.4.0)
    Rcpp               1.0.14  2025-01-12 [1] CRAN (R 4.4.1)
    readr              2.1.5   2024-01-10 [1] CRAN (R 4.4.0)
    reshape2           1.4.4   2020-04-09 [1] CRAN (R 4.4.0)
 VP rlang            * 1.1.5   2025-04-11 [2] CRAN (R 4.4.1) (on disk 1.1.6)
    rmarkdown          2.29    2024-11-04 [1] CRAN (R 4.4.1)
    rprojroot          2.0.4   2023-11-05 [1] CRAN (R 4.4.0)
    RSQLite            2.3.9   2024-12-03 [1] CRAN (R 4.4.1)
    rstudioapi         0.17.1  2024-10-22 [1] CRAN (R 4.4.1)
    S4Vectors          0.44.0  2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    scales             1.4.0   2025-04-24 [1] CRAN (R 4.4.1)
    sessioninfo        1.2.3   2025-02-05 [1] CRAN (R 4.4.1)
    stringi            1.8.7   2025-03-27 [1] CRAN (R 4.4.1)
    stringr            1.5.1   2023-11-14 [1] CRAN (R 4.4.0)
    tibble             3.2.1   2023-03-20 [1] CRAN (R 4.4.0)
    tidyr              1.3.1   2024-01-24 [1] CRAN (R 4.4.0)
    tidyselect         1.2.1   2024-03-11 [1] CRAN (R 4.4.0)
    tidytree           0.4.6   2023-12-12 [1] CRAN (R 4.4.0)
    treeio             1.30.0  2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    tzdb               0.5.0   2025-03-15 [1] CRAN (R 4.4.3)
    UCSC.utils         1.2.0   2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    vctrs              0.6.5   2023-12-01 [1] CRAN (R 4.4.0)
    withr              3.0.2   2024-10-28 [1] CRAN (R 4.4.1)
    xfun               0.52    2025-04-02 [1] CRAN (R 4.4.1)
    XVector            0.46.0  2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
    yaml               2.3.10  2024-07-26 [1] CRAN (R 4.4.0)
    yulab.utils        0.2.0   2025-01-29 [1] CRAN (R 4.4.1)
    zlibbioc           1.52.0  2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)

 [1] /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library
 [2] /Users/bmulvey/Library/R/arm64/4.4/library

 * ── Packages attached to the search path.
 V ── Loaded and on-disk version mismatch.
 P ── Loaded and on-disk path mismatch.

───────────────────────────────────────────────────────────────────────────────────
