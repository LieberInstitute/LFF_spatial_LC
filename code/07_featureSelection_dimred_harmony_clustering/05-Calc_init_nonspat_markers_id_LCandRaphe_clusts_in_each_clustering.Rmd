---
title: "05-Calc_init_nonspat_markers_id_LCandRaphe_clusts_in_each_clustering"
author: "Bernie Mulvey"
date: "2024-12-29"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.height = 10,fig.width = 7,include = FALSE)
#### sets tab autocompletion for directories to begin from the directory containing the .Rproj session, instead of the script's directory if different
knitr::opts_knit$set(root.dir = here::here())

library(data.table)
library(spatialLIBD)
library(SpatialExperiment)

library(parallelly)
options(parallelly.supportsMulticore.disableOn="")
options(parallelly.fork.enable=TRUE)
library(BiocParallel)
options(bphost="localhost")
library(parallel)

## for reasons i can't get my head around, parallelizing on this one only worked with foreah/doparallel
library(foreach)
library(doParallel)

## last of all, unload the base package datasets, whose data keep getting in the way of autocompletions (e.g., Theoph is priortized over TRUE)
unloadNamespace("datasets")
```

# 
```{r}
lc3 <- readRDS("processed-data/06-QCed_SPE_split_to_tissSections.RDS")

## cut excesses from SPE
imgData(lc3) <- NULL
logcounts(lc3) <- NULL
gc(full=T)

## load clustering results
SNNlouvlist <- readRDS("processed-data/07_featureSelection_dimred_harmony_clustering/04-Initial_louvLeid_res0.5-1-2_clusterings.RDS")
## all clustering assignments are in columns with names reflecting the feature set, clustering method, and resolution parameter. the leiden ones are all crazy (hundreds of clusters, so we don't need those). but we can make this into one big table.
i<-1
for (i in c(1:length(SNNlouvlist))){
    if(i==1){SNNlouvs <- copy(SNNlouvlist[[1]])} else {
        SNNlouvs <- merge.data.table(SNNlouvs,SNNlouvlist[[i]],by="rn")
    }
}
keepn <- grep(names(SNNlouvs),pattern="_leid_",value=T,invert=T)
SNNlouvs <- SNNlouvs[,..keepn]

SNNlouvs <- DataFrame(SNNlouvs,row.names=SNNlouvs$rn)[colnames(lc3),]
SNNlouvs$rn <- NULL

# clean up again
rm(SNNlouvlist,i,keepn)
gc(full=T)
```

### calculate markers for each clustering set
```{r}
tmpcd <- as.data.table(colData(lc3),keep.rownames=T)
tmpcd <- merge.data.table(tmpcd,as.data.table(SNNlouvs,keep.rownames=T),by="rn")
tmpcd <- DataFrame(tmpcd,row.names=tmpcd$rn)[colnames(lc3),]
tmpcd$rn <- NULL
colData(lc3) <- tmpcd
rm(tmpcd)

clusts <- colnames(SNNlouvs)

## parallelize -- even though this should work with mclapply directly, it doesn't. this also seems to somehow use 200-300% CPU per spawned worker which makes no fucking sense to me but hey.
cl <- makePSOCKcluster(3)
registerDoParallel(cl)

mkl <- foreach(clus=clusts,.export="lc3",.packages = c("SpatialExperiment","data.table","spatialLIBD")) %dopar% {
   setDTthreads(1,restore_after_fork = FALSE) ## otherwise we'll have 3 workers with DT trying to use 6 virtual cores ea, with only 12 virtual cores avail.
   
   mks <- registration_wrapper(lc3,var_registration = clus,var_sample_id = "sample_id",gene_ensembl = "gene_id",gene_name = "gene_name")
   
   mks2 <- as.data.table(mks[["enrichment"]],keep.rownames=T)
   mks2
}
stopCluster(cl)

names(mkl) <- clusts

saveRDS(mkl,"processed-data/07_featureSelection_dimred_harmony_clustering/05a-init_nonspat_marker_tables.RDS")

rm(cl)
gc(full=T)
```

### rearrange each of these into long format, pull out any clusters with signif enrichment of absolute LC markers (DBH, 6A2, etc), raphe markers (TPH2, SLC6A4, FEV, etc), and misc GABAergic clusters. make cluster ID - autoannotation table for each clustering result so we can label the probable LC, raphe, GABAergic clusters in each clustering to mark in plots and compare between clustering approaches.

```{r}
setDTthreads(8,restore_after_fork = T) # we can turn this back on now

mkl2 <- lapply(mkl,FUN=function(x){
   y <- copy(x)
   y[,ensembl:=NULL]
   y <- melt(y,id.vars=c("rn","gene"))
   y[,value:=as.numeric(value)]
   y[,clusid:=gsub(variable,pattern="^.*_(X.*)$",replacement="\\1")]
   y[,stat:=gsub(variable,pattern="^(.*)_X.*$",replacement="\\1")]
   
   yf <- y[stat=="fdr"]
   setnames(yf,"value","fdr")
   yf[,variable:=NULL]
   
   yl <- y[stat=="logFC"]
   setnames(yl,"value","logFC")
   yl[,variable:=NULL]
   
   y2 <- merge.data.table(yf,yl,by=c("rn","gene","clusid"))
   y2 <- y2[fdr<0.1&logFC>1]
   
   lcclus <- unique(y2[gene %in% c("DBH","SLC6A2","PHOX2A","PHOX2B"),clusid])
   lcann <- paste0("LC.",c(1:length(lcclus)))
   if(length(lcclus)>0){
      lclut <- cbind(lcclus,lcann)
   } else {lclut <- NULL}
   
   htclus <- unique(y2[gene %in% c("FEV","SLC6A4","TPH1","TPH2")&!(clusid %in% lcclus),clusid])
   htann <- paste0("5HT.",c(1:length(htclus)))
   if(length(htclus)>0){
      htlut <- cbind(htclus,htann)
   } else {htlut <- NULL}
   
   gabclus <- unique(y2[gene %in% c("GAD1","GAD2","SLC32A1")&!(clusid %in% c(lcclus,htclus)),clusid])
   gabann <- paste0("GABA.",c(1:length(gabclus)))
   if(length(gabclus)>0){
      gablut <- cbind(gabclus,gabann)
   } else {gablut <- NULL}

   manan <- as.data.table(rbind(lclut,htlut,gablut,
      cbind(unique(y[!(clusid %in% c(lcclus,htclus,gabclus)),clusid]),unique(y[!(clusid %in% c(lcclus,htclus,gabclus)),clusid]))
   ))
   
   setnames(manan,c("clusid","autoanno"))
   return(manan)
})

saveRDS(mkl2,"processed-data/07_featureSelection_dimred_harmony_clustering/05b-init_clusterings_autoannoLCrapheAndGABAergic.RDS")
```

reprod inf
```{r}
sessionInfo()
sessioninfo::session_info()
```
R version 4.4.1 RC (2024-06-06 r86719)
Platform: aarch64-apple-darwin20
Running under: macOS Sonoma 14.7.1

Matrix products: default
BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Chicago
tzcode source: internal

attached base packages:
[1] parallel  stats4    stats     graphics  grDevices utils     methods   base     

other attached packages:
 [1] doParallel_1.0.17           iterators_1.0.14           
 [3] foreach_1.5.2               BiocParallel_1.40.0        
 [5] parallelly_1.40.1           spatialLIBD_1.18.0         
 [7] SpatialExperiment_1.16.0    SingleCellExperiment_1.28.1
 [9] SummarizedExperiment_1.36.0 Biobase_2.66.0             
[11] GenomicRanges_1.58.0        GenomeInfoDb_1.42.1        
[13] IRanges_2.40.1              S4Vectors_0.44.0           
[15] BiocGenerics_0.52.0         MatrixGenerics_1.18.0      
[17] matrixStats_1.4.1           data.table_1.16.4          
[19] rlang_1.1.4                

loaded via a namespace (and not attached):
  [1] RColorBrewer_1.1-3       rstudioapi_0.17.1        jsonlite_1.8.9          
  [4] magrittr_2.0.3           ggbeeswarm_0.7.2         magick_2.8.5            
  [7] rmarkdown_2.29           BiocIO_1.16.0            fields_16.3             
 [10] zlibbioc_1.52.0          vctrs_0.6.5              memoise_2.0.1           
 [13] config_0.3.2             Rsamtools_2.22.0         paletteer_1.6.0         
 [16] RCurl_1.98-1.16          benchmarkme_1.0.8        htmltools_0.5.8.1       
 [19] S4Arrays_1.6.0           AnnotationHub_3.14.0     curl_6.0.1              
 [22] BiocNeighbors_2.0.1      SparseArray_1.6.0        sass_0.4.9              
 [25] bslib_0.8.0              htmlwidgets_1.6.4        plotly_4.10.4           
 [28] cachem_1.1.0             GenomicAlignments_1.42.0 mime_0.12               
 [31] lifecycle_1.0.4          pkgconfig_2.0.3          rsvd_1.0.5              
 [34] Matrix_1.7-1             R6_2.5.1                 fastmap_1.2.0           
 [37] GenomeInfoDbData_1.2.13  shiny_1.9.1              digest_0.6.37           
 [40] colorspace_2.1-1         rematch2_2.1.2           AnnotationDbi_1.68.0    
 [43] scater_1.34.0            rprojroot_2.0.4          irlba_2.3.5.1           
 [46] ExperimentHub_2.14.0     RSQLite_2.3.9            beachmat_2.22.0         
 [49] filelock_1.0.3           fansi_1.0.6              httr_1.4.7              
 [52] abind_1.4-8              compiler_4.4.1           here_1.0.1              
 [55] bit64_4.5.2              attempt_0.3.1            viridis_0.6.5           
 [58] DBI_1.2.3                maps_3.4.2.1             sessioninfo_1.2.2       
 [61] rappdirs_0.3.3           DelayedArray_0.32.0      rjson_0.2.23            
 [64] tools_4.4.1              vipor_0.4.7              beeswarm_0.4.0          
 [67] httpuv_1.6.15            glue_1.8.0               restfulr_0.0.15         
 [70] promises_1.3.2           grid_4.4.1               snow_0.4-4              
 [73] generics_0.1.3           gtable_0.3.6             tidyr_1.3.1             
 [76] ScaledMatrix_1.14.0      BiocSingular_1.22.0      utf8_1.2.4              
 [79] XVector_0.46.0           ggrepel_0.9.6            BiocVersion_3.20.0      
 [82] pillar_1.9.0             spam_2.11-0              limma_3.62.1            
 [85] later_1.4.1              benchmarkmeData_1.0.4    dplyr_1.1.4             
 [88] BiocFileCache_2.14.0     lattice_0.22-6           rtracklayer_1.66.0      
 [91] bit_4.5.0.1              tidyselect_1.2.1         locfit_1.5-9.10         
 [94] scuttle_1.16.0           Biostrings_2.74.0        knitr_1.49              
 [97] gridExtra_2.3            edgeR_4.4.1              xfun_0.49               
[100] statmod_1.5.0            DT_0.33                  UCSC.utils_1.2.0        
[103] lazyeval_0.2.2           yaml_2.3.10              shinyWidgets_0.8.7      
[106] evaluate_1.0.1           codetools_0.2-20         tibble_3.2.1            
[109] BiocManager_1.30.25      cli_3.6.3                xtable_1.8-4            
[112] jquerylib_0.1.4          munsell_0.5.1            golem_0.5.1             
[115] Rcpp_1.0.13-1            dbplyr_2.5.0             png_0.1-8               
[118] XML_3.99-0.17            ggplot2_3.5.1            blob_1.2.4              
[121] dotCall64_1.2            bitops_1.0-9             viridisLite_0.4.2       
[124] scales_1.3.0             purrr_1.0.2              crayon_1.5.3            
[127] cowplot_1.1.3            KEGGREST_1.46.0         
> sessioninfo::session_info()
─ Session info ──────────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.4.1 RC (2024-06-06 r86719)
 os       macOS Sonoma 14.7.1
 system   aarch64, darwin20
 ui       RStudio
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       America/Chicago
 date     2025-01-04
 rstudio  2024.07.0-daily+219 Cranberry Hibiscus (desktop)
 pandoc   3.1.11 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/aarch64/ (via rmarkdown)

─ Packages ──────────────────────────────────────────────────────────────────────
 ! package              * version   date (UTC) lib source
   abind                  1.4-8     2024-09-12 [1] CRAN (R 4.4.1)
   AnnotationDbi          1.68.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   AnnotationHub          3.14.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   attempt                0.3.1     2020-05-03 [1] CRAN (R 4.4.0)
   beachmat               2.22.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   beeswarm               0.4.0     2021-06-01 [1] CRAN (R 4.4.0)
   benchmarkme            1.0.8     2022-06-12 [1] CRAN (R 4.4.0)
   benchmarkmeData        1.0.4     2020-04-23 [1] CRAN (R 4.4.0)
   Biobase              * 2.66.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   BiocFileCache          2.14.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   BiocGenerics         * 0.52.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   BiocIO                 1.16.0    2024-12-12 [1] Github (Bioconductor/BiocIO@8e80624)
   BiocManager            1.30.25   2024-08-28 [1] CRAN (R 4.4.1)
   BiocNeighbors          2.0.1     2024-11-28 [1] Bioconductor 3.20 (R 4.4.2)
   BiocParallel         * 1.40.0    2024-11-23 [1] Bioconductor 3.20 (R 4.4.2)
   BiocSingular           1.22.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   BiocVersion            3.20.0    2024-05-04 [1] Bioconductor 3.20 (R 4.4.0)
   Biostrings             2.74.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   bit                    4.5.0.1   2024-12-03 [1] CRAN (R 4.4.1)
   bit64                  4.5.2     2024-09-22 [1] CRAN (R 4.4.1)
   bitops                 1.0-9     2024-10-03 [1] CRAN (R 4.4.1)
   blob                   1.2.4     2023-03-17 [1] CRAN (R 4.4.0)
   bslib                  0.8.0     2024-07-29 [1] CRAN (R 4.4.0)
   cachem                 1.1.0     2024-05-16 [1] CRAN (R 4.4.0)
 P cli                    3.6.3     2024-06-21 [2] CRAN (R 4.4.0)
   codetools              0.2-20    2024-03-31 [1] CRAN (R 4.4.1)
   colorspace             2.1-1     2024-07-26 [1] CRAN (R 4.4.0)
   config                 0.3.2     2023-08-30 [1] CRAN (R 4.4.0)
   cowplot                1.1.3     2024-01-22 [1] CRAN (R 4.4.0)
   crayon                 1.5.3     2024-06-20 [1] CRAN (R 4.4.0)
   curl                   6.0.1     2024-11-14 [1] CRAN (R 4.4.1)
   data.table           * 1.16.4    2024-12-06 [1] CRAN (R 4.4.1)
   DBI                    1.2.3     2024-06-02 [1] CRAN (R 4.4.0)
   dbplyr                 2.5.0     2024-03-19 [1] CRAN (R 4.4.0)
   DelayedArray           0.32.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   digest                 0.6.37    2024-08-19 [1] CRAN (R 4.4.1)
   doParallel           * 1.0.17    2022-02-07 [1] CRAN (R 4.4.1)
   dotCall64              1.2       2024-10-04 [1] CRAN (R 4.4.1)
   dplyr                  1.1.4     2023-11-17 [1] CRAN (R 4.4.0)
   DT                     0.33      2024-04-04 [1] CRAN (R 4.4.0)
   edgeR                  4.4.1     2024-12-02 [1] Bioconductor 3.20 (R 4.4.2)
   evaluate               1.0.1     2024-10-10 [1] CRAN (R 4.4.1)
   ExperimentHub          2.14.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   fansi                  1.0.6     2023-12-08 [1] CRAN (R 4.4.0)
   fastmap                1.2.0     2024-05-15 [1] CRAN (R 4.4.0)
   fields                 16.3      2024-09-30 [1] CRAN (R 4.4.1)
   filelock               1.0.3     2023-12-11 [1] CRAN (R 4.4.0)
   foreach              * 1.5.2     2022-02-02 [1] CRAN (R 4.4.0)
   generics               0.1.3     2022-07-05 [1] CRAN (R 4.4.0)
   GenomeInfoDb         * 1.42.1    2024-11-28 [1] Bioconductor 3.20 (R 4.4.2)
   GenomeInfoDbData       1.2.13    2024-12-12 [1] Bioconductor
   GenomicAlignments      1.42.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   GenomicRanges        * 1.58.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   ggbeeswarm             0.7.2     2023-04-29 [1] CRAN (R 4.4.0)
   ggplot2                3.5.1     2024-04-23 [1] CRAN (R 4.4.0)
   ggrepel                0.9.6     2024-09-07 [1] CRAN (R 4.4.1)
   glue                   1.8.0     2024-09-30 [1] CRAN (R 4.4.1)
   golem                  0.5.1     2024-08-27 [1] CRAN (R 4.4.1)
   gridExtra              2.3       2017-09-09 [1] CRAN (R 4.4.0)
   gtable                 0.3.6     2024-10-25 [1] CRAN (R 4.4.1)
   here                   1.0.1     2020-12-13 [1] CRAN (R 4.4.0)
   htmltools              0.5.8.1   2024-04-04 [1] CRAN (R 4.4.0)
   htmlwidgets            1.6.4     2023-12-06 [1] CRAN (R 4.4.0)
   httpuv                 1.6.15    2024-03-26 [1] CRAN (R 4.4.0)
   httr                   1.4.7     2023-08-15 [1] CRAN (R 4.4.0)
   IRanges              * 2.40.1    2024-12-05 [1] Bioconductor 3.20 (R 4.4.2)
   irlba                  2.3.5.1   2022-10-03 [1] CRAN (R 4.4.0)
   iterators            * 1.0.14    2022-02-05 [1] CRAN (R 4.4.0)
   jquerylib              0.1.4     2021-04-26 [1] CRAN (R 4.4.0)
   jsonlite               1.8.9     2024-09-20 [1] CRAN (R 4.4.1)
   KEGGREST               1.46.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   knitr                  1.49      2024-11-08 [1] CRAN (R 4.4.1)
   later                  1.4.1     2024-11-27 [1] CRAN (R 4.4.1)
   lattice                0.22-6    2024-03-20 [1] CRAN (R 4.4.1)
   lazyeval               0.2.2     2019-03-15 [1] CRAN (R 4.4.0)
   lifecycle              1.0.4     2023-11-07 [1] CRAN (R 4.4.0)
   limma                  3.62.1    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   locfit                 1.5-9.10  2024-06-24 [1] CRAN (R 4.4.0)
   magick                 2.8.5     2024-09-20 [1] CRAN (R 4.4.1)
   magrittr               2.0.3     2022-03-30 [1] CRAN (R 4.4.0)
   maps                   3.4.2.1   2024-11-10 [1] CRAN (R 4.4.1)
   Matrix                 1.7-1     2024-10-18 [1] CRAN (R 4.4.1)
   MatrixGenerics       * 1.18.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   matrixStats          * 1.4.1     2024-09-08 [1] CRAN (R 4.4.1)
   memoise                2.0.1     2021-11-26 [1] CRAN (R 4.4.0)
   mime                   0.12      2021-09-28 [1] CRAN (R 4.4.0)
   munsell                0.5.1     2024-04-01 [1] CRAN (R 4.4.0)
   paletteer              1.6.0     2024-01-21 [1] CRAN (R 4.4.0)
   parallelly           * 1.40.1    2024-12-04 [1] CRAN (R 4.4.1)
   pillar                 1.9.0     2023-03-22 [1] CRAN (R 4.4.0)
   pkgconfig              2.0.3     2019-09-22 [1] CRAN (R 4.4.0)
   plotly                 4.10.4    2024-01-13 [1] CRAN (R 4.4.0)
   png                    0.1-8     2022-11-29 [1] CRAN (R 4.4.0)
   promises               1.3.2     2024-11-28 [1] CRAN (R 4.4.1)
   purrr                  1.0.2     2023-08-10 [1] CRAN (R 4.4.0)
   R6                     2.5.1     2021-08-19 [1] CRAN (R 4.4.0)
   rappdirs               0.3.3     2021-01-31 [1] CRAN (R 4.4.0)
   RColorBrewer           1.1-3     2022-04-03 [1] CRAN (R 4.4.0)
   Rcpp                   1.0.13-1  2024-11-02 [1] CRAN (R 4.4.1)
   RCurl                  1.98-1.16 2024-07-11 [1] CRAN (R 4.4.0)
   rematch2               2.1.2     2020-05-01 [1] CRAN (R 4.4.0)
   restfulr               0.0.15    2022-06-16 [1] CRAN (R 4.4.0)
   rjson                  0.2.23    2024-09-16 [1] CRAN (R 4.4.1)
 P rlang                * 1.1.4     2024-06-04 [2] CRAN (R 4.4.1)
   rmarkdown              2.29      2024-11-04 [1] CRAN (R 4.4.1)
   rprojroot              2.0.4     2023-11-05 [1] CRAN (R 4.4.0)
   Rsamtools              2.22.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   RSQLite                2.3.9     2024-12-03 [1] CRAN (R 4.4.1)
   rstudioapi             0.17.1    2024-10-22 [1] CRAN (R 4.4.1)
   rsvd                   1.0.5     2021-04-16 [1] CRAN (R 4.4.0)
   rtracklayer            1.66.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   S4Arrays               1.6.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   S4Vectors            * 0.44.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   sass                   0.4.9     2024-03-15 [1] CRAN (R 4.4.0)
   ScaledMatrix           1.14.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   scales                 1.3.0     2023-11-28 [1] CRAN (R 4.4.0)
   scater                 1.34.0    2024-10-29 [1] Bioconductor 3.20 (R 4.4.1)
   scuttle                1.16.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   sessioninfo            1.2.2     2021-12-06 [1] CRAN (R 4.4.0)
   shiny                  1.9.1     2024-08-01 [1] CRAN (R 4.4.0)
   shinyWidgets           0.8.7     2024-09-23 [1] CRAN (R 4.4.1)
   SingleCellExperiment * 1.28.1    2024-11-23 [1] Bioconductor 3.20 (R 4.4.2)
   snow                   0.4-4     2021-10-27 [1] CRAN (R 4.4.0)
   spam                   2.11-0    2024-10-03 [1] CRAN (R 4.4.1)
   SparseArray            1.6.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   SpatialExperiment    * 1.16.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   spatialLIBD          * 1.18.0    2024-11-07 [1] Bioconductor 3.20 (R 4.4.1)
   statmod                1.5.0     2023-01-06 [1] CRAN (R 4.4.0)
   SummarizedExperiment * 1.36.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   tibble                 3.2.1     2023-03-20 [1] CRAN (R 4.4.0)
   tidyr                  1.3.1     2024-01-24 [1] CRAN (R 4.4.0)
   tidyselect             1.2.1     2024-03-11 [1] CRAN (R 4.4.0)
   UCSC.utils             1.2.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   utf8                   1.2.4     2023-10-22 [1] CRAN (R 4.4.0)
   vctrs                  0.6.5     2023-12-01 [1] CRAN (R 4.4.0)
   vipor                  0.4.7     2023-12-18 [1] CRAN (R 4.4.0)
   viridis                0.6.5     2024-01-29 [1] CRAN (R 4.4.0)
   viridisLite            0.4.2     2023-05-02 [1] CRAN (R 4.4.0)
   xfun                   0.49      2024-10-31 [1] CRAN (R 4.4.1)
   XML                    3.99-0.17 2024-06-25 [1] CRAN (R 4.3.3)
   xtable                 1.8-4     2019-04-21 [1] CRAN (R 4.4.0)
   XVector                0.46.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   yaml                   2.3.10    2024-07-26 [1] CRAN (R 4.4.0)
   zlibbioc               1.52.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)

 [1] /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library
 [2] /Users/bmulvey/Library/R/arm64/4.4/library

 P ── Loaded and on-disk path mismatch.

─────────────────────────────────────────────────────────────────────────────────
