---
title: "05-Calc_init_nonspatial_clust_QCmetrics"
author: "Bernie Mulvey"
date: "2024-12-29"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(fig.height = 10,fig.width = 7,include = FALSE)
#### sets tab autocompletion for directories to begin from the directory containing the .Rproj session, instead of the script's directory if different
knitr::opts_knit$set(root.dir = here::here())

library(data.table)
library(bluster)
library(HDF5Array)

## rstudio GUI tweaks
require(colorout)
ColorOut()
options("styler.addins_style_transformer" = "biocthis::bioc_style()")
##

## enable forked parallel processing with BiocParallel::multicoreParam, future::, etc. seemed to need this a couple times, but otherwise havent so its here as a preventative measure. part of this is adding the line 
# OBJC_DISABLE_INITIALIZE_FORK_SAFETY=YES
# to Renviron.site. see e.g. top response on https://stackoverflow.com/questions/73638290/python-on-mac-is-it-safe-to-set-objc-disable-initialize-fork-safety-yes-globall 
library(parallelly)
options(parallelly.supportsMulticore.disableOn="")
options(parallelly.fork.enable=TRUE)
library(BiocParallel)
options(bphost="localhost")
library(parallel)

## last of all, unload the base package datasets, whose data keep getting in the way of autocompletions (e.g., Theoph is priortized over TRUE)
unloadNamespace("datasets")
```

# Silhouette Widths
## load dimred matrices, clustering results from the same matrix (the two inputs to bluster for sil. widths)
```{r}
dimrs <- readRDS("processed-data/07_featureSelection_dimred_harmony_clustering/02-PCA_harmo_UMAP_matrices_HiDevG_HVG_SVG_andmixed_featsets.RDS") 
glmdimrs <- readRDS("processed-data/07_featureSelection_dimred_harmony_clustering/03-initial_HDG-SVG-HVG_sets_nullResid_to_approxGLMPCA.RDS")

## in both of these list objects, the HARMONY corrected dimreds are in slots 3, 7, ...
alldimrs <- c(lapply(seq(3,35,4),function(x){dimrs[[x]]}),lapply(seq(3,35,4),function(x){glmdimrs[[x]]}))
names(alldimrs) <- c(names(dimrs)[seq(3,35,4)],names(glmdimrs)[seq(3,35,4)])
## clean up
rm(dimrs,glmdimrs)


## load clustering results
SNNlouvlist <- readRDS("processed-data/07_featureSelection_dimred_harmony_clustering/04-Initial_louvLeid_res0.5-1-2_clusterings.RDS")
## all clustering assignments are in columns with names reflecting the feature set, clustering method, and resolution parameter. the leiden ones are all crazy (hundreds of clusters, so we don't need those). but we can make this into one big table.
i<-1
for (i in c(1:length(SNNlouvlist))){
    if(i==1){SNNlouvs <- copy(SNNlouvlist[[1]])} else {
        SNNlouvs <- merge.data.table(SNNlouvs,SNNlouvlist[[i]],by="rn")
    }
}
keepn <- grep(names(SNNlouvs),pattern="_leid_",value=T,invert=T)
SNNlouvs <- SNNlouvs[,..keepn]

# clean up again
rm(SNNlouvlist,i,keepn)
gc(full=T)
```

### calculate silhouette withs from the cluster assignments and the corresponding dimensionality reduction matrix
```{r}
## this is easier if we use the dimred list names as the lapply variable (because then we can search for that name in the cluster name columsn without having to manipulate column name strings)
featdrnames <- names(alldimrs)

## run silhouette width approximation for each clustering result and the underlying glmpca mat
silres <- mclapply(X=featdrnames,mc.cores=5,FUN=function(fdrn){
    getcols <- grep(names(SNNlouvs),pattern=fdrn,value=T)
    curdr <- alldimrs[[fdrn]]
    
    i<-1
    subl <- list()
    for (i in c(1:length(getcols))){
        curcols <- c("rn",getcols[i])
        clusts <- copy(SNNlouvs[,..curcols])
        clusts <- as.data.frame(clusts,row.names=clusts$rn)
        
        # get the row orders matched up between cluster assignments and dimred
        clusts <- clusts[rownames(curdr),]
        clusts$rn <- NULL
        names(clusts)[1] <- "curclus"
        silwidths <- approxSilhouette(x = curdr,clusters = clusts$curclus)
        subl[[i]] <- silwidths
        names(subl)[i] <- getcols[i]
        
        rm(curcols,clusts,silwidths)
    }

    return(subl)
})

silres2 <- list()
i<-1
for (i in c(1:length(silres))){
    silres2 <- c(silres2,silres[[i]])
}

### save results
saveRDS(silres2,"processed-data/07_featureSelection_dimred_harmony_clustering/05a-init_SNNk10_louvainClusts_silwidths.RDS")

rm(silres,silres2,i)
```

### cluster purity in bluster (same inputs)
```{r}
## run cluster purity in bluster for each clustering result and the underlying (glm)pca mat
clpur <- mclapply(X=featdrnames,mc.cores=5,FUN=function(fdrn){
    getcols <- grep(names(SNNlouvs),pattern=fdrn,value=T)
    curdr <- alldimrs[[fdrn]]
    
    i<-1
    subl <- list()
    for (i in c(1:length(getcols))){
        curcols <- c("rn",getcols[i])
        clusts <- copy(SNNlouvs[,..curcols])
        clusts <- as.data.frame(clusts,row.names=clusts$rn)
        
        # get the row orders matched up between cluster assignments and dimred
        clusts <- clusts[rownames(curdr),]
        clusts$rn <- NULL
        names(clusts)[1] <- "curclus"
        clustpurity <- neighborPurity(x = curdr,clusters = clusts$curclus)
        subl[[i]] <- clustpurity
        names(subl)[i] <- getcols[i]
        
        rm(curcols,clusts,clustpurity)
    }
})
names(clpur) <- featdrnames

clpur2 <- list()
i<-1
for (i in c(1:length(clpur))){
    clpur2 <- c(clpur2,clpur[[i]])
}

### save results
saveRDS(clpur2,"processed-data/07_featureSelection_dimred_harmony_clustering/05b-init_SNNk10_louvain_clustpuritys.RDS")
```

cluster RMSDs
```{r}
crmsd <- mclapply(X=featdrnames,mc.cores=5,FUN=function(fdrn){
    getcols <- grep(names(SNNlouvs),pattern=fdrn,value=T)
    curdr <- alldimrs[[fdrn]]
    
    i<-1
    subl <- list()
    for (i in c(1:length(getcols))){
        curcols <- c("rn",getcols[i])
        clusts <- copy(SNNlouvs[,..curcols])
        clusts <- as.data.frame(clusts,row.names=clusts$rn)
        
        # get the row orders matched up between cluster assignments and dimred
        clusts <- clusts[rownames(curdr),]
        clusts$rn <- NULL
        names(clusts)[1] <- "curclus"
        cRMSD <- clusterRMSD(x = curdr,clusters = clusts$curclus)
        subl[[i]] <- cRMSD
        names(subl)[i] <- getcols[i]
        
        rm(curcols,clusts,cRMSD)
    }
    
    return(subl)
})
names(crmsd) <- featdrnames

crmsd2 <- list()
i<-1
for (i in c(1:length(crmsd))){
    crmsd2 <- c(crmsd2,crmsd[[i]])
}

saveRDS(crmsd2,"processed-data/07_featureSelection_dimred_harmony_clustering/05c-init_SNNk10_louvain_clustRMSDs.RDS")
```

reprod inf
```{r}
sessionInfo()
sessioninfo::session_info()
```
R version 4.4.1 RC (2024-06-06 r86719)
Platform: aarch64-apple-darwin20
Running under: macOS Sonoma 14.7.1

Matrix products: default
BLAS:   /System/Library/Frameworks/Accelerate.framework/Versions/A/Frameworks/vecLib.framework/Versions/A/libBLAS.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: America/Chicago
tzcode source: internal

attached base packages:
[1] parallel  stats4    stats     graphics  grDevices utils     methods   base     

other attached packages:
 [1] HDF5Array_1.34.0            rhdf5_2.50.0               
 [3] DelayedArray_0.32.0         SparseArray_1.6.0          
 [5] S4Arrays_1.6.0              abind_1.4-8                
 [7] Matrix_1.7-1                bluster_1.16.0             
 [9] spatialLIBD_1.18.0          BiocParallel_1.40.0        
[11] parallelly_1.40.1           colorout_1.3-0.2           
[13] SpatialExperiment_1.16.0    SingleCellExperiment_1.28.1
[15] SummarizedExperiment_1.36.0 Biobase_2.66.0             
[17] GenomicRanges_1.58.0        GenomeInfoDb_1.42.1        
[19] IRanges_2.40.1              S4Vectors_0.44.0           
[21] BiocGenerics_0.52.0         MatrixGenerics_1.18.0      
[23] matrixStats_1.4.1           data.table_1.16.4          
[25] rlang_1.1.4                

loaded via a namespace (and not attached):
  [1] later_1.4.1              BiocIO_1.16.0            bitops_1.0-9            
  [4] filelock_1.0.3           fields_16.3              tibble_3.2.1            
  [7] XML_3.99-0.17            lifecycle_1.0.4          edgeR_4.4.1             
 [10] doParallel_1.0.17        rprojroot_2.0.4          lattice_0.22-6          
 [13] magrittr_2.0.3           limma_3.62.1             plotly_4.10.4           
 [16] sass_0.4.9               rmarkdown_2.29           jquerylib_0.1.4         
 [19] yaml_2.3.10              httpuv_1.6.15            spam_2.11-0             
 [22] sessioninfo_1.2.2        cowplot_1.1.3            DBI_1.2.3               
 [25] RColorBrewer_1.1-3       golem_0.5.1              maps_3.4.2.1            
 [28] zlibbioc_1.52.0          purrr_1.0.2              RCurl_1.98-1.16         
 [31] rappdirs_0.3.3           GenomeInfoDbData_1.2.13  ggrepel_0.9.6           
 [34] irlba_2.3.5.1            codetools_0.2-20         DT_0.33                 
 [37] scuttle_1.16.0           tidyselect_1.2.1         UCSC.utils_1.2.0        
 [40] ScaledMatrix_1.14.0      viridis_0.6.5            shinyWidgets_0.8.7      
 [43] BiocFileCache_2.14.0     GenomicAlignments_1.42.0 jsonlite_1.8.9          
 [46] BiocNeighbors_2.0.1      scater_1.34.0            iterators_1.0.14        
 [49] foreach_1.5.2            tools_4.4.1              Rcpp_1.0.13-1           
 [52] glue_1.8.0               gridExtra_2.3            xfun_0.49               
 [55] here_1.0.1               dplyr_1.1.4              BiocManager_1.30.25     
 [58] fastmap_1.2.0            rhdf5filters_1.18.0      fansi_1.0.6             
 [61] digest_0.6.37            rsvd_1.0.5               R6_2.5.1                
 [64] mime_0.12                colorspace_2.1-1         RSQLite_2.3.9           
 [67] config_0.3.2             utf8_1.2.4               tidyr_1.3.1             
 [70] generics_0.1.3           rtracklayer_1.66.0       httr_1.4.7              
 [73] htmlwidgets_1.6.4        pkgconfig_2.0.3          gtable_0.3.6            
 [76] blob_1.2.4               XVector_0.46.0           htmltools_0.5.8.1       
 [79] dotCall64_1.2            scales_1.3.0             png_0.1-8               
 [82] attempt_0.3.1            knitr_1.49               rstudioapi_0.17.1       
 [85] rjson_0.2.23             curl_6.0.1               cachem_1.1.0            
 [88] BiocVersion_3.20.0       vipor_0.4.7              AnnotationDbi_1.68.0    
 [91] restfulr_0.0.15          pillar_1.9.0             grid_4.4.1              
 [94] vctrs_0.6.5              promises_1.3.2           BiocSingular_1.22.0     
 [97] dbplyr_2.5.0             beachmat_2.22.0          xtable_1.8-4            
[100] cluster_2.1.8            beeswarm_0.4.0           paletteer_1.6.0         
[103] evaluate_1.0.1           magick_2.8.5             cli_3.6.3               
[106] locfit_1.5-9.10          compiler_4.4.1           Rsamtools_2.22.0        
[109] crayon_1.5.3             rematch2_2.1.2           ggbeeswarm_0.7.2        
[112] viridisLite_0.4.2        munsell_0.5.1            Biostrings_2.74.0       
[115] lazyeval_0.2.2           ExperimentHub_2.14.0     benchmarkme_1.0.8       
[118] bit64_4.5.2              Rhdf5lib_1.28.0          ggplot2_3.5.1           
[121] KEGGREST_1.46.0          statmod_1.5.0            shiny_1.9.1             
[124] AnnotationHub_3.14.0     igraph_2.1.2             memoise_2.0.1           
[127] bslib_0.8.0              benchmarkmeData_1.0.4    bit_4.5.0.1             
> sessioninfo::session_info()
─ Session info ───────────────────────────────────────────────────────────────────
 setting  value
 version  R version 4.4.1 RC (2024-06-06 r86719)
 os       macOS Sonoma 14.7.1
 system   aarch64, darwin20
 ui       RStudio
 language (EN)
 collate  en_US.UTF-8
 ctype    en_US.UTF-8
 tz       America/Chicago
 date     2025-01-02
 rstudio  2024.07.0-daily+219 Cranberry Hibiscus (desktop)
 pandoc   3.1.11 @ /Applications/RStudio.app/Contents/Resources/app/quarto/bin/tools/aarch64/ (via rmarkdown)

─ Packages ───────────────────────────────────────────────────────────────────────
 ! package              * version   date (UTC) lib source
   abind                * 1.4-8     2024-09-12 [1] CRAN (R 4.4.1)
   AnnotationDbi          1.68.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   AnnotationHub          3.14.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   attempt                0.3.1     2020-05-03 [1] CRAN (R 4.4.0)
   beachmat               2.22.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   beeswarm               0.4.0     2021-06-01 [1] CRAN (R 4.4.0)
   benchmarkme            1.0.8     2022-06-12 [1] CRAN (R 4.4.0)
   benchmarkmeData        1.0.4     2020-04-23 [1] CRAN (R 4.4.0)
   Biobase              * 2.66.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   BiocFileCache          2.14.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   BiocGenerics         * 0.52.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   BiocIO                 1.16.0    2024-12-12 [1] Github (Bioconductor/BiocIO@8e80624)
   BiocManager            1.30.25   2024-08-28 [1] CRAN (R 4.4.1)
   BiocNeighbors          2.0.1     2024-11-28 [1] Bioconductor 3.20 (R 4.4.2)
   BiocParallel         * 1.40.0    2024-11-23 [1] Bioconductor 3.20 (R 4.4.2)
   BiocSingular           1.22.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   BiocVersion            3.20.0    2024-05-04 [1] Bioconductor 3.20 (R 4.4.0)
   Biostrings             2.74.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   bit                    4.5.0.1   2024-12-03 [1] CRAN (R 4.4.1)
   bit64                  4.5.2     2024-09-22 [1] CRAN (R 4.4.1)
   bitops                 1.0-9     2024-10-03 [1] CRAN (R 4.4.1)
   blob                   1.2.4     2023-03-17 [1] CRAN (R 4.4.0)
   bluster              * 1.16.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   bslib                  0.8.0     2024-07-29 [1] CRAN (R 4.4.0)
   cachem                 1.1.0     2024-05-16 [1] CRAN (R 4.4.0)
 P cli                    3.6.3     2024-06-21 [2] CRAN (R 4.4.0)
   cluster                2.1.8     2024-12-11 [1] CRAN (R 4.4.1)
   codetools              0.2-20    2024-03-31 [1] CRAN (R 4.4.1)
   colorout             * 1.3-0.2   2024-05-01 [1] Github (jalvesaq/colorout@c6113a2)
   colorspace             2.1-1     2024-07-26 [1] CRAN (R 4.4.0)
   config                 0.3.2     2023-08-30 [1] CRAN (R 4.4.0)
   cowplot                1.1.3     2024-01-22 [1] CRAN (R 4.4.0)
   crayon                 1.5.3     2024-06-20 [1] CRAN (R 4.4.0)
   curl                   6.0.1     2024-11-14 [1] CRAN (R 4.4.1)
   data.table           * 1.16.4    2024-12-06 [1] CRAN (R 4.4.1)
   DBI                    1.2.3     2024-06-02 [1] CRAN (R 4.4.0)
   dbplyr                 2.5.0     2024-03-19 [1] CRAN (R 4.4.0)
   DelayedArray         * 0.32.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   digest                 0.6.37    2024-08-19 [1] CRAN (R 4.4.1)
   doParallel             1.0.17    2022-02-07 [1] CRAN (R 4.4.1)
   dotCall64              1.2       2024-10-04 [1] CRAN (R 4.4.1)
   dplyr                  1.1.4     2023-11-17 [1] CRAN (R 4.4.0)
   DT                     0.33      2024-04-04 [1] CRAN (R 4.4.0)
   edgeR                  4.4.1     2024-12-02 [1] Bioconductor 3.20 (R 4.4.2)
   evaluate               1.0.1     2024-10-10 [1] CRAN (R 4.4.1)
   ExperimentHub          2.14.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   fansi                  1.0.6     2023-12-08 [1] CRAN (R 4.4.0)
   fastmap                1.2.0     2024-05-15 [1] CRAN (R 4.4.0)
   fields                 16.3      2024-09-30 [1] CRAN (R 4.4.1)
   filelock               1.0.3     2023-12-11 [1] CRAN (R 4.4.0)
   foreach                1.5.2     2022-02-02 [1] CRAN (R 4.4.0)
   generics               0.1.3     2022-07-05 [1] CRAN (R 4.4.0)
   GenomeInfoDb         * 1.42.1    2024-11-28 [1] Bioconductor 3.20 (R 4.4.2)
   GenomeInfoDbData       1.2.13    2024-12-12 [1] Bioconductor
   GenomicAlignments      1.42.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   GenomicRanges        * 1.58.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   ggbeeswarm             0.7.2     2023-04-29 [1] CRAN (R 4.4.0)
   ggplot2                3.5.1     2024-04-23 [1] CRAN (R 4.4.0)
   ggrepel                0.9.6     2024-09-07 [1] CRAN (R 4.4.1)
   glue                   1.8.0     2024-09-30 [1] CRAN (R 4.4.1)
   golem                  0.5.1     2024-08-27 [1] CRAN (R 4.4.1)
   gridExtra              2.3       2017-09-09 [1] CRAN (R 4.4.0)
   gtable                 0.3.6     2024-10-25 [1] CRAN (R 4.4.1)
   HDF5Array            * 1.34.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   here                   1.0.1     2020-12-13 [1] CRAN (R 4.4.0)
   htmltools              0.5.8.1   2024-04-04 [1] CRAN (R 4.4.0)
   htmlwidgets            1.6.4     2023-12-06 [1] CRAN (R 4.4.0)
   httpuv                 1.6.15    2024-03-26 [1] CRAN (R 4.4.0)
   httr                   1.4.7     2023-08-15 [1] CRAN (R 4.4.0)
   igraph                 2.1.2     2024-12-07 [1] CRAN (R 4.4.1)
   IRanges              * 2.40.1    2024-12-05 [1] Bioconductor 3.20 (R 4.4.2)
   irlba                  2.3.5.1   2022-10-03 [1] CRAN (R 4.4.0)
   iterators              1.0.14    2022-02-05 [1] CRAN (R 4.4.0)
   jquerylib              0.1.4     2021-04-26 [1] CRAN (R 4.4.0)
   jsonlite               1.8.9     2024-09-20 [1] CRAN (R 4.4.1)
   KEGGREST               1.46.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   knitr                  1.49      2024-11-08 [1] CRAN (R 4.4.1)
   later                  1.4.1     2024-11-27 [1] CRAN (R 4.4.1)
   lattice                0.22-6    2024-03-20 [1] CRAN (R 4.4.1)
   lazyeval               0.2.2     2019-03-15 [1] CRAN (R 4.4.0)
   lifecycle              1.0.4     2023-11-07 [1] CRAN (R 4.4.0)
   limma                  3.62.1    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   locfit                 1.5-9.10  2024-06-24 [1] CRAN (R 4.4.0)
   magick                 2.8.5     2024-09-20 [1] CRAN (R 4.4.1)
   magrittr               2.0.3     2022-03-30 [1] CRAN (R 4.4.0)
   maps                   3.4.2.1   2024-11-10 [1] CRAN (R 4.4.1)
   Matrix               * 1.7-1     2024-10-18 [1] CRAN (R 4.4.1)
   MatrixGenerics       * 1.18.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   matrixStats          * 1.4.1     2024-09-08 [1] CRAN (R 4.4.1)
   memoise                2.0.1     2021-11-26 [1] CRAN (R 4.4.0)
   mime                   0.12      2021-09-28 [1] CRAN (R 4.4.0)
   munsell                0.5.1     2024-04-01 [1] CRAN (R 4.4.0)
   paletteer              1.6.0     2024-01-21 [1] CRAN (R 4.4.0)
   parallelly           * 1.40.1    2024-12-04 [1] CRAN (R 4.4.1)
   pillar                 1.9.0     2023-03-22 [1] CRAN (R 4.4.0)
   pkgconfig              2.0.3     2019-09-22 [1] CRAN (R 4.4.0)
   plotly                 4.10.4    2024-01-13 [1] CRAN (R 4.4.0)
   png                    0.1-8     2022-11-29 [1] CRAN (R 4.4.0)
   promises               1.3.2     2024-11-28 [1] CRAN (R 4.4.1)
   purrr                  1.0.2     2023-08-10 [1] CRAN (R 4.4.0)
   R6                     2.5.1     2021-08-19 [1] CRAN (R 4.4.0)
   rappdirs               0.3.3     2021-01-31 [1] CRAN (R 4.4.0)
   RColorBrewer           1.1-3     2022-04-03 [1] CRAN (R 4.4.0)
   Rcpp                   1.0.13-1  2024-11-02 [1] CRAN (R 4.4.1)
   RCurl                  1.98-1.16 2024-07-11 [1] CRAN (R 4.4.0)
   rematch2               2.1.2     2020-05-01 [1] CRAN (R 4.4.0)
   restfulr               0.0.15    2022-06-16 [1] CRAN (R 4.4.0)
   rhdf5                * 2.50.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   rhdf5filters           1.18.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   Rhdf5lib               1.28.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   rjson                  0.2.23    2024-09-16 [1] CRAN (R 4.4.1)
 P rlang                * 1.1.4     2024-06-04 [2] CRAN (R 4.4.1)
   rmarkdown              2.29      2024-11-04 [1] CRAN (R 4.4.1)
   rprojroot              2.0.4     2023-11-05 [1] CRAN (R 4.4.0)
   Rsamtools              2.22.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   RSQLite                2.3.9     2024-12-03 [1] CRAN (R 4.4.1)
   rstudioapi             0.17.1    2024-10-22 [1] CRAN (R 4.4.1)
   rsvd                   1.0.5     2021-04-16 [1] CRAN (R 4.4.0)
   rtracklayer            1.66.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   S4Arrays             * 1.6.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   S4Vectors            * 0.44.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   sass                   0.4.9     2024-03-15 [1] CRAN (R 4.4.0)
   ScaledMatrix           1.14.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   scales                 1.3.0     2023-11-28 [1] CRAN (R 4.4.0)
   scater                 1.34.0    2024-10-29 [1] Bioconductor 3.20 (R 4.4.1)
   scuttle                1.16.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   sessioninfo            1.2.2     2021-12-06 [1] CRAN (R 4.4.0)
   shiny                  1.9.1     2024-08-01 [1] CRAN (R 4.4.0)
   shinyWidgets           0.8.7     2024-09-23 [1] CRAN (R 4.4.1)
   SingleCellExperiment * 1.28.1    2024-11-23 [1] Bioconductor 3.20 (R 4.4.2)
   spam                   2.11-0    2024-10-03 [1] CRAN (R 4.4.1)
   SparseArray          * 1.6.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   SpatialExperiment    * 1.16.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   spatialLIBD          * 1.18.0    2024-11-07 [1] Bioconductor 3.20 (R 4.4.1)
   statmod                1.5.0     2023-01-06 [1] CRAN (R 4.4.0)
   SummarizedExperiment * 1.36.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   tibble                 3.2.1     2023-03-20 [1] CRAN (R 4.4.0)
   tidyr                  1.3.1     2024-01-24 [1] CRAN (R 4.4.0)
   tidyselect             1.2.1     2024-03-11 [1] CRAN (R 4.4.0)
   UCSC.utils             1.2.0     2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   utf8                   1.2.4     2023-10-22 [1] CRAN (R 4.4.0)
   vctrs                  0.6.5     2023-12-01 [1] CRAN (R 4.4.0)
   vipor                  0.4.7     2023-12-18 [1] CRAN (R 4.4.0)
   viridis                0.6.5     2024-01-29 [1] CRAN (R 4.4.0)
   viridisLite            0.4.2     2023-05-02 [1] CRAN (R 4.4.0)
   xfun                   0.49      2024-10-31 [1] CRAN (R 4.4.1)
   XML                    3.99-0.17 2024-06-25 [1] CRAN (R 4.3.3)
   xtable                 1.8-4     2019-04-21 [1] CRAN (R 4.4.0)
   XVector                0.46.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)
   yaml                   2.3.10    2024-07-26 [1] CRAN (R 4.4.0)
   zlibbioc               1.52.0    2024-11-08 [1] Bioconductor 3.20 (R 4.4.1)

 [1] /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/library
 [2] /Users/bmulvey/Library/R/arm64/4.4/library

 P ── Loaded and on-disk path mismatch.

──────────────────────────────────────────────────────────────────────────────────
